Source: [US20100036292A1](https://patents.google.com/patent/US20100036292A1)

# [US20100036292A1](US20100036292A1.md) - Optimization and feedback control of hifu power deposition through the analysis of detected signal characteristics

## Details

* Date: 2008-08-06
* Inventor: Mirabilis Medica Inc
* Beneficiary: Gregory P. Darlington, Charles D. Emery, Justin A. Reed, Barry Friemel

## Other patents

### Backwards
 * [US3470868A](US3470868A.md)
 * [US3480002A](US3480002A.md)
 * [US3676584A](US3676584A.md)
 * US3941112A
 * [US4059098A](US4059098A.md)
 * US4097835A
 * US4185502A
 * [US4282755A](US4282755A.md)
 * US4347850A
 * [US4484569A](US4484569A.md)
 * US4742829A
 * [US4756313A](US4756313A.md)
 * US4819621A
 * US4835689A
 * [US4858613A](US4858613A.md)
 * [US4865042A](US4865042A.md)
 * US4893624A
 * [US4932414A](US4932414A.md)
 * [US5005579A](US5005579A.md)
 * [US5036855A](US5036855A.md)
 * [US5070879A](US5070879A.md)
 * US5080660A
 * [US5080101A](US5080101A.md)
 * [US5117832A](US5117832A.md)
 * US5234429A
 * [US5271402A](US5271402A.md)
 * [US5391140A](US5391140A.md)
 * US5441499A
 * [US5471988A](US5471988A.md)
 * US5474071A
 * [US5492126A](US5492126A.md)
 * [US5520188A](US5520188A.md)
 * [US5558092A](US5558092A.md)
 * US5619999A
 * [US5720287A](US5720287A.md)
 * [US5762066A](US5762066A.md)
 * [US5769790A](US5769790A.md)
 * US5810007A
 * US5882302A
 * US5976092A
 * US5984881A
 * US6002251A
 * [US6007499A](US6007499A.md)
 * US6042556A
 * [US6050943A](US6050943A.md)
 * [US6071239A](US6071239A.md)
 * US6126607A
 * US6196972B1
 * US6217530B1
 * US6254601B1
 * US20010017848A1
 * US6390973B1
 * [US6425867B1](US6425867B1.md)
 * US20020120192A1
 * US6451013B1
 * US6461314B1
 * US20020147397A1
 * US6488639B1
 * US20030149380A1
 * US20030189488A1
 * US6632177B1
 * US6645162B2
 * US20040030268A1
 * US20040039312A1
 * US20040082859A1
 * US6837855B1
 * US20050085726A1
 * US20050107702A1
 * US6936046B2
 * US20050281444A1
 * US20060056273A1
 * [US20070010805A1](US20070010805A1.md)
 * US20070016042A1
 * US7175596B2
 * US20070083120A1
 * US20070106157A1
 * US20070167798A1
 * US20070239011A1
 * US20070255267A1
 * US20070270792A1
 * [US20080039724A1](US20080039724A1.md)
 * US20080058683A1
 * US20080071165A1
 * US20080086036A1
 * US20080253525A1
 * US20090000626A1
### Forward
 * US20070239077A1
 * US20100106019A1
 * WO2011141918A3
 * EP2446823A1
 * US20120232388A1
 * EP2552546A2
 * US20130102904A1
 * US8617150B2
 * US20140135681A1
 * CN104013419A
 * WO2014146005A1
 * US8852103B2
 * CN104093452A
 * US20150272547A1
 * EP2962730A1
 * US9242122B2
 * US9273992B2
 * RU2608433C2
 * US9573000B2
 * [US9667889B2](US9667889B2.md)
 * US9707414B2
 * US9770593B2
 * US10004557B2
 * WO2018225040A1
 * WO2019006243A1
 * US10383685B2
 * US10478249B2
## Abstract

Abstract

A system and method for adjusting or selecting the treatment parameters for HIFU signals to treat a target treatment site, and/or to aid in visualizing the likely degree and location of HIFU effects on patient tissue. The system transmits one or more test signals into patient tissue and receives signals created in response to the test signals. The signals are analyzed to determine a response curve of how a characteristic of the signal varies with the one or more test signals. The response curve of the detected signals is used to select a treatment parameter.



A system and method for adjusting or selecting the treatment parameters for HIFU signals to treat a target treatment site, and/or to aid in visualizing the likely degree and location of HIFU effects on patient tissue. The system transmits one or more test signals into patient tissue and receives signals created in response to the test signals. The signals are analyzed to determine a response curve of how a characteristic of the signal varies with the one or more test signals. The response curve of the detected signals is used to select a treatment parameter.

CROSS-REFERENCES TO RELATED APPLICATIONS
   This application is a continuation-in-part of U.S. patent application Ser. No. 12/187,318, filed Aug. 6, 2008, and also claims the benefit of U.S. Patent Application No. 61/180,187, filed May 21, 2009, both of which are expressly incorporated herein by reference.
 BACKGROUND
   As an alternative to more invasive types of surgical procedures, many physicians are employing the use of High Intensity Focused Ultrasound (HIFU) as a technique to therapeutically treat internal body tissues. With HIFU, an ultrasound signal of sufficient power (pressure and particle velocity) and time is focused on a target volume of tissue in order to change a state of the tissue by heating and/or by cavitation.
    To be effective in treating tissue, the delivered energy of the HIFU signal must be sufficient to cause the desired physical effect. Additionally, the energy must not be so great or uncontrolled as to cause unintended collateral damage to healthy tissues surrounding the target volume. The non-homogenous nature of tissue(s) in the body creates variations in attenuation, propagation velocity, and acoustic impedance that modify the expected acoustic wave propagation and deposition of HIFU energy delivered to a target tissue volume when compared to homogeneous material. The technology disclosed herein is a method and apparatus for dynamically controlling and/or selecting parameters that affect the energy of a HIFU signal and/or the location where the energy is directed so that the desired physical effect in tissue is obtained and collateral damage to surrounding tissue is minimized.
 SUMMARY
   As indicated above, the technology disclosed herein is a method and apparatus for selecting and/or controlling one or more treatment parameters such as the energy of a HIFU signal delivered by a transducer to a desired location in a patient. The one or more treatment parameters are selected or controlled based on an analysis of harmonic distortion or other changes in a detected signal characteristic that occur as a result of a high amplitude pressure waveform traveling through tissue.
    To select a treatment parameter of a HIFU signal that will be used to treat a target tissue site, one or more test signals are delivered to the tissue. Each test signal is a continuous wave (CW) or pulsed mode ultrasound signal that is focused on a target volume in the patient. Signals created by the test signals are received and analyzed to determine a response curve of the tissue that indicates how a signal characteristic changes in response to the one or more test signals. Examples of detected signal characteristics include but are not limited to: energy, power, amplitude, frequency, energy at one or more frequencies or range of frequencies, duration, temperature change, dispersion or acoustic radiation force. The treatment parameter is selected or controlled based on the response curve(s).
    In one embodiment, a response curve is compared to find a match against predefined response curves having treatment parameters associated therewith and the treatment parameter(s) of the closest matching response curve is selected.
    In another embodiment, a treatment parameter is selected by analyzing a characteristic of the response curve, such as a saturation point or slope and the treatment parameter(s) associated with the characteristic is selected.
    In yet another embodiment, a treatment parameter is selected by comparing the response curves to threshold values.
    In one embodiment, the response curve is determined by comparing the energy of the received signals created from the test signals in one frequency range to the energy of the received signals in a second frequency range. This comparison is used to calculate K, which is the ratio of the energy in the two frequency ranges. In one embodiment, the energy in the harmonic content of the waveform is compared to the energy in the fundamental frequency. In another embodiment, the energy in a single harmonic, such as the second harmonic, is compared to the energy at the fundamental frequency. In yet another embodiment, the energy in one group of frequencies is compared to the energy in another group of frequencies, of which one may contain the fundamental frequency. In yet another embodiment, the phase difference for the harmonics can be used to calculate K.
    The ratio K may be found for a multitude of spatial positions from the transducer. This may be accomplished through windowing of the received signals from the tissue at a specific time and calculating the Fourier transform. The response curve formed by the values of K as a function of spatial location may be compared to a baseline response curve, and the excitation signal may be adjusted to optimize the HIFU energy delivered to the intended target volume.
    In one particular embodiment, the disclosed technology relates to a method and apparatus for selecting a power level for a high intensity focused ultrasound (HIFU) signal to be delivered by a HIFU transducer that operates by: transmitting a test signal having a fundamental frequency to a target volume; receiving ultrasound echoes from one or more positions; determining an energy of the received echoes in a first frequency range and an energy of the echo signals in a second frequency range; comparing the energy of the received echoes in the first frequency range and the energy of the echo signals in the second frequency range; and based on the comparison, adjusting one or more characteristics of the HIFU signal to adjust the energy of the HIFU signal delivered by the HIFU transducer.
    In still a further embodiment, the method and apparatus operate such that the first frequency range does not include the fundamental frequency of the test signal and the second frequency range does include the fundamental frequency of the test signal.
    In still a further embodiment, the method and apparatus operate such that the first frequency range includes one or more harmonics of the fundamental frequency of the test signal.
    In still a further embodiment, the method and apparatus operate such that the energy of the received echoes in the first frequency range and the energy of the echoes in the second frequency range are compared by determining a ratio of an energy of the echoes in the first frequency range to an energy of the echoes in the second frequency range.
    In yet another embodiment, the method and apparatus operate such that the delivered energy of the HIFU signal is adjusted by determining if the ratio at a selected position is less than a threshold, and if so, adjusting a characteristic of the HIFU signal to increase the delivered energy of the HIFU signal at the selected position.
    In yet another embodiment, the method and apparatus operate so that the delivered energy of the HIFU signal is adjusted by determining if the ratio at a selected position is greater than a threshold, and if so, adjusting a characteristic of the HIFU signal to decrease the delivered energy of the HIFU signal at the selected position.
    In yet another embodiment, the method and apparatus operate so that the energy of the echoes in the first frequency range and the energy of the echoes in the second frequency range are compared by determining a difference in phase between the echoes in the first frequency range and the second frequency range.
    In yet another embodiment, the method and apparatus operate so that the adjustment of one or more characteristics of the HIFU signal is made based on the magnitude of the difference in phase.
    In another embodiment, the response curve of the signal characteristic relates a dispersion of an echo signal to variations in test signal power. The dispersion may be detected as an amount of speckle shift toward the HIFU transducer. The one or more treatment parameters are controlled or selected based on the amount of speckle shift detected.
    In another embodiment, the response curve of the signal characteristic relates how the energy contained in a received signal at one harmonic or at the fundamental frequency of the test signals varies in response to variations in test signal power.
    In another embodiment, the response curve of the signal characteristic relates how a speckle shift due to heating within the tissue changes with changes in test signal power.
    In one embodiment, a single test signal at each power level is used to measure the response of the signal characteristic. In another embodiment, two interrogations signals are used for each power level tested. The interrogation signals have the same overall power, but are 180 degrees out of phase. In this case, the signals received from tissue created by the two signals are added together to suppress the fundamental frequency and give a record of the harmonics generated within tissue.
    This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This summary is not intended to identify key features of the claimed subject matter, nor is it intended to be used as an aid in determining the scope of the claimed subject matter.
 
DESCRIPTION OF THE DRAWINGS
   The foregoing aspects and many of the attendant advantages of the disclosed technology will become more readily appreciated as the same become better understood by reference to the following detailed description, when taken in conjunction with the accompanying drawings, wherein:
     FIG. 1 illustrates a basic system for controlling the energy of a delivered HIFU signal, in accordance with an embodiment of the disclosed technology;
     FIG. 2A shows a received echo as a function of time;
     FIG. 2B shows a received echo as a function of distance;
     FIG. 3 shows windowed sections of a received echo at three different distances;
     FIG. 4 shows the frequency spectrum of a windowed echo (distance of 35 mm) with the fundamental, 3rd and 5th harmonics identified;
     FIG. 5 shows a surface plot of the power in decibels as a function of frequency and distance mapped to a grayscale;
     FIG. 6 shows an expected K value curve as a function of distance ‘r’;
     FIGS. 7A-7C show a surface plot of the power in decibels as a function of frequency and depth taken at three different times, t0, t1 and t2;
     FIG. 8 shows a graphical representation of K value matrices for different distances and acquisition times;
     FIG. 9 shows a graphical representation of the steps performed to obtain K value curves and change the energy/power of a delivered HIFU signal in accordance with an embodiment of the disclosed technology;
     FIGS. 10A-10C illustrate the differences between burst length, burst interval, pulse length, and pulse rate interval of a pulsed HIFU signal;
     FIG. 11 illustrates an embodiment of a HIFU treatment system in which the disclosed technology can be implemented;
     FIGS. 12A and 12B illustrate different types of transducer probes that transmit HIFU signals and receive echo signals from the patient;
     FIGS. 13A and 13B illustrate different feedback control systems to adjust the energy of a delivered HIFU signal; and
     FIG. 14 illustrates a system for adjusting the delivered energy of a HIFU signal in accordance with another embodiment of the disclosed technology;
     FIG. 15 illustrates the amplitude versus depth of an echo signal created in tissue as a result of a HIFU signal;
     FIG. 16 is a graph of the energy in the echo signal at the fundamental frequency of the HIFU signal versus depth;
     FIG. 17 is a graph of the energy in the echo signal at the second harmonic of the HIFU signal versus depth;
     FIG. 18 is a two dimensional plot of the energy in the echo signal at the second harmonic of the HIFU signal versus depth and power level of a HIFU signal;
     FIG. 19 is a plot of the energy in the echo signal at the second harmonic of the HIFU signal versus the power level of a HIFU signal.
     FIG. 20 is a plot of dispersion created in echo signals in response to HIFU signals transmitted at different power levels;
     FIG. 21 is a plot of dispersion created in echo signals in response to HIFU signals transmitted at different power levels;
     FIG. 22 is a flowchart of steps performed to select a power level for HIFU signals to be used to treat a tissue site in accordance with an embodiment of the disclosed technology; and
     FIG. 23 illustrates a system for adjusting a focus point of a delivered HIFU signal in accordance with another aspect of the disclosed technology.
 
DETAILED DESCRIPTION
   Although the technology disclosed herein is described with respect to its currently preferred embodiments and the best mode known for practicing the technology, the description is not to be construed as limiting. The disclosure is directed to all new and non-obvious features and aspects of the disclosed embodiments either taken alone or in combination. As discussed above, the technology disclosed herein relates to techniques for adjusting or selecting one or more treatment parameters of a HIFU signal such as the energy of a HIFU signal and/or the location at which the energy is delivered. For the purposes of this application, the energy of a HIFU signal may be characterized by its power, pressure or other related characteristic. Other treatment parameters that can be controlled or selected include the treatment times of the HIFU signals, pulse repetition frequency, pulse duration of the HIFU signals or other parameters that effect the amount or rate at which energy is deposited at a tissue treatment site.
    As will be described in further detail below, the one or more treatment parameters of the HIFU signals that are used to treat a tissue site are controlled or selected based on an analysis of how the signal characteristics of received signals vary in response to one or more test signals. In a currently preferred embodiment, the test signals are one or more HIFU signals. However, the test signals could be any type of ultrasound signal including non-focused or imaging ultrasound signals. The same transducer may be used to deliver both the therapeutic HIFU signals and the test signals or different ultrasound transducers could be used.
    In one embodiment, to select the value of a treatment parameter, a number of test signals at different power levels are transmitted into the tissue. The test signals may be transmitted to the same tissue region as the target treatment site or the test signals may be transmitted into tissue into tissue that is nearby the target treatment site.
    As the power level of the test signals increase, the transmitted test signals become increasingly non-linear in the tissue in the focal zone of the ultrasound transducer. The non-linearity creates a corresponding response curve of a signal characteristic that can be detected and used to select the appropriate treatment parameter. In one embodiment, the response curve is analyzed for a power level of a test signal that causes the detected signal characteristic to saturate. The saturation power level is used as a basis for selecting the treatment parameter.
    The treatment parameter may be selected for each tissue site to be treated. Alternatively, the selected treatment parameter may be used to treat several different areas or cross-sections of the tissue site to be treated.
     FIG. 1 shows a diagram of a system for selecting a treatment parameter such as the energy of a HIFU signal for use in treating a tissue site in accordance with an embodiment of the disclosed technology. The system 10 includes a HIFU transducer 12 that delivers a HIFU signal to tissue 14 and HIFU electronics 16 that excites the transducer 12. A voltage probe 18 detects an electrical signal at the HIFU transducer 12. The system further includes an oscilloscope or other data acquisition system 20. In this case, an excitation signal from the HIFU electronics 16 stimulates the HIFU transducer 12 such that a high energy ultrasound signal is transmitted to the intended target in tissue 14. The energy in the HIFU signal is scattered, reflected, transmitted and absorbed as it propagates within the tissue. The absorbed energy is converted to heat and causes the temperature of the tissue to rise. The amount of energy absorbed depends on the pressure amplitude and frequency as well as the tissue characteristics. Typically, a HIFU device is designed such that the greatest pressure and absorption occur at the focal point of the device in the tissue. Energy of the signal that is not absorbed is either transmitted to deeper tissues or reflected and scattered. In one embodiment of the disclosed technology, it is the reflected and scattered energy (ultrasound echoes) that can be detected and analyzed for harmonic distortion. Some of this scattered acoustic energy is detected by the HIFU transducer 12 and converted into an electrical signal. The electrical signal is sensed using the voltage probe 18 and displayed/acquired on the oscilloscope or other data acquisition system 20.
     FIG. 2A shows a representative signal captured at the data acquisition system 20 with three regions identified, namely transmit, pulse-echo saturation, and pulse-echo signal. For this example, the focal depth is 35 mm for the HIFU transducer. If it is assumed that acquisition starts immediately when transmit begins, then the first detected signal will contain mostly information from the transmit pulse (transmit region). After transmit ends, it is expected that some of the first few echoes may cause clipping in the detection system (pulse-echo saturation). The issues with pulse-echo saturation may be mitigated by properly designing the detection circuit to ensure satisfactory dynamic range and bandwidth (e.g. time-gain control). After the initial large amplitude echoes have been received, the echoes from the tissue may be detected without any additional distortion added from the detection system (pulse-echo signal). Since in the embodiment shown, the HIFU transducer and detection transducer are the same, the time axis also represents depth through knowledge of the propagation velocity in the tissue as shown in FIG. 2B.
    The energy of the echo signals as a function of frequency may be computed at different depths or spatial locations. In one case, the received echo signal is multiplied by a windowing function centered at a specific depth and the Fourier transform operator is applied. In the example shown in FIG. 3, echo signals are isolated at depths centered at 25, 35 and 45 mm with a rectangular function which is 5 mm in width. It is expected that the window width and amplitude will be adjusted to optimize the frequency representation of the echo signal. A Fourier transform of the echo signals at each depth signal is calculated to determine the energy of the echo signals as a function of frequency. FIG. 4 shows the frequency spectrum for the signal windowed at 35 mm. In this case, the fundamental frequency, 3rd harmonic, and 5th harmonic are identified. The even harmonics are typically not as easy to detect due to therapy transducer limitations. Although only three depths are shown in FIG. 3, the window function can run along the entire length of the pulse-echo signal or vector. In this case, a matrix of data is computed such that one axis is depth and the other axis is frequency. FIG. 5 shows a three dimensional surface plot in grayscale of a continuous analysis along the depth dimension. In this representation, the fundamental frequency of 1.1 MHz has been removed using a digital filter, which highlights the harmonics seen at 3.3 MHz and 5.5 MHz.
    The Fourier transform determines the energy that occurs in a number of frequency bins. Therefore, the energy in a particular frequency bin may be compared to the energy in other frequency bins or the energy over multiple frequency bins may be summed and compared. For example, frequencies around the fundamental frequency (e.g. bandwidth) may be a better representation of the power. EQUATIONS 1A and 1B show two different cases for calculating a ratio K, of the energy as represented by the power at two different frequencies or in different frequency ranges.
    As with many signal processing schemes, signal conditioning may be required to detect and properly represent the energy of the echo signals at the various frequencies. For example, the sensitivity of the detection transducer or attenuation as a function of frequency and depth may need to be introduced to fully appreciate differences in the energy at the various frequencies in tissue.
  








K

f


 


1

f


 


0




(
r
)


=


P


(


f
1

,
r

)



P


(


f
0

,
r

)







(

1

A

)








K

f


 


1

f


 


0




(
r
)


=



∑

f
=


f
1

-

Δ


 


f





f
1

+

Δ


 


f





P


(

f
,
r

)





∑

f
=


f
0

-

Δ


 


f





f
0

+

Δ


 


f





P


(

f
,
r

)








(

1

B

)







     FIG. 5 shows that the K values can be calculated as a function of spatial position or depth; therefore, K is a function of r or spatial distance. It is important to note that the calculation may include one frequency or multiple frequencies. For example, the K value may represent the energy in the harmonics compared to the energy in the fundamental.
     FIG. 6 shows an example of how the K values are expected to vary as a function of depth. In this example, the energy around the fundamental is compared to the energy in the harmonics. As can be seen, the ratio K has a maximum at or adjacent the focal point of the HIFU signal and then decreases with increasing distance away from the transducer.
    As described, it is possible to map the energy ratio as a function of frequency and spatial location for an echo. If the excitation level at the transducer is modified, then it is also possible to compare K values for different HIFU transducer pressures. The echoes are also available at different sampling intervals (pulse repetition interval). For example, if a pulse mode HIFU excitation is used, then the echo may be detected and analyzed between the excitation signals. This allows the K values to be compared for multiple excitation levels and/or multiple times. FIGS. 7A-7C show multiple surface plots that have been acquired from different echoes at times t0, t1 and t2. This may be due to variation in excitation level or just processing between excitation times. The frequency spectrum at each spatial location is calculated, and then K is calculated.
     FIG. 8 shows a representative format for storing K data in a computer memory. In one embodiment, the data is stored in a table 50 where one axis 52 is spatial location (depth) and another axis 54 is acquisition time. Each entry for a particular depth and time contains a matrix, e.g., 56, wherein the power ratio between two frequencies is calculated and stored. In this representation, Kf2f0 is the power ratio in the third harmonic to the fundamental frequency. Kf2f1 is the power ratio in the third harmonic to the second harmonic. Since K is just a ratio of the power in two frequencies, Kf2f1 is simply the multiplicative inverse of Kf1f2. If it is necessary to compare the power in the fundamental to all harmonics, then essentially the column needs to be summed as set forth in EQUATION 2.
    K total(r 0 ,t 0)=K ∫  2  ∫ 0(r 0 ,t 0)+K ∫  2  ∫  0 (r 0 ,t 0)+K∫  3  ∫  0 (r 0 ,t 0)+ . . . +K ∫  N  ∫  0 (r 0 ,t 0)   (2)
     FIG. 8 also shows that the K values may be calculated at different excitation times t0, t1, t2, etc. By comparing the K values at these times (note: the excitation may vary at these different times) between each other or to a baseline, the approximate location of the focus may be determined as well as an estimate of the energy of the HIFU signal delivered to the tissue.
    The values of K can be used to select a treatment parameter for the HIFU signals to be used in treating a tissue site by analyzing the K curve determined for the tissue. As indicated above, the system transmits one or more test signals into the patient and detects signals created by the test signals. The ratio, K, of the energy detected in different frequency bands versus depth can be used to create a K curve. The K curve of the detected signals can be compared against known K curves for which treatment parameters have already been determined. For example, breast tissue may be associated with a K curve having a first set of one or more treatment parameters. Fibroid tissue may be associated with another K curve having different treatment parameters. In one embodiment, a processor compares the K curve for the detected signals with a library of K curves to determine the closest match and selects the treatment parameters associated for the closest match.
    In another embodiment, one or more individual points on a K curve for the detected signals can be compared with a predetermined baseline K curve. The value for the treatment parameter can be adjusted based on the comparison. For example, if the characteristic curve formed by K as a function of spatial location for the detected signals shows significantly higher ratios than the baseline curve, then the output energy (pressure) may be reduced. Similarly, if the characteristic curve formed by K as a function of spatial location for the detected signals shows significantly lower ratios (or flatter) than the baseline curve, then the output energy may be increased.
    It is also possible to show harmonic saturation (maximum value for the ratio K) by graphing the K values as a function of the excitation amplitude for a particular depth. In this case, a number of test HIFU signals are transmitted at different power levels and the K values for the detected signals are computed. A curve or plot of the change in K versus changes in HIFU power for a particular depth are computed. The curve or plot can then be compared against known plots having treatment parameters associated with them. Alternatively, the K curve can be compared with a baseline K curve and the treatment parameters selected.
    In one embodiment, one or more points on the K curve for the detected signals are used to select the treatment parameters. In one embodiment, the K curve can be searched for a HIFU power level that causes the value of K to saturate. The treatment parameters of the HIFU signals used to treat a tissue sample can therefore be selected based on the HIFU power which causes the K value to saturate. For example, if the HIFU power that causes the value of K to saturate is 1500 watts, then the treatment parameters associated with a 1500 watt level can be used to treat the tissue. In some cases it may be useful to use the same power to treat the tissue as the power that causes the value of K to saturate. In other cases, other power levels (greater or lessor) could be used.
    In yet another embodiment, other characteristics of the K curve for the detected signals can be used to select the treatment parameters. For example, the slope of the K curve can be compared with slopes of K curves having treatment parameters associated with them or the slope of the K curve for the detected signals can be compared with a baseline and the treatment parameters adjusted accordingly.
    If the excitation level is constant during the treatment, the energy level of the harmonics and their location may suggest the amount of heating occurring throughout the tissue. This would help determine a limit to the amount of energy delivered to the intended target.
    It should be also noted that although the power spectrum has been calculated at different depth and acquisition times, the phase may also be used to determine the amount of heating in tissue.
    Since the K-value may be derived by the taking the Fourier transform of the echo signals, the power (energy per unit time) falling within each frequency bin as well as the phase is available for computation. The magnitude and phase in a particular frequency bin may be expressed in the following equation:
    H(f 1)=A(f 1)*e −j2πφ(f  1  )   (3)
  where A(f1) is the amplitude of the signal at frequency f1 (the power is simply the square of A) and φ(f1) is the phase of the signal at frequency f1. Therefore, the phase difference between two frequency bins may be computed by taking the ratio of Equation 3 with the magnitude normalized to 1:
  







∈


f
1



f
0





=





-
j



 


2


πϕ


(

f
1

)







-

j2πϕ


(

f
0

)










(
4
)







  Equation 4 may be rewritten as
   εf  1  f  0  =e −j2π(φ(f  1  )−φ( f 0))   (5)
  The argument in Equation 5 is the phase difference between the two signals. The phase difference as a function of depth at different excitation levels may also be used as a relative measure of energy in different frequencies or frequency bands, which in turn may be used to dynamically control or select a treatment parameter of a HIFU signal. For example, the magnitude of the phrase difference can be compared to a threshold previously known to relate the phase difference to delivered energy in the tissue. One or more characteristics of the HIFU signal can then be adjusted in accordance with the comparison.
     FIG. 9 shows a summary of the basic steps to acquire the K values in accordance with one embodiment of the disclosed technology. First, the HIFU transducer is excited with a single frequency (fo) as shown in graph 1. The HIFU signal may be a continuous wave (CW) or a pulsed sinusoid with a fundamental frequency f0. In the case of CW, the pulse repetition interval is equal to the pulse length. As shown in graph 1, the HIFU excitation signal generated at the HIFU transducer probe has a signature spectrum where the energy of the frequency components that are different from the fundamental frequency of the HIFU signal, such as the harmonics, f1, f2, f3, etc., are negligible compared with the energy of the fundamental frequency f0. The high pressures created from the transmitted HIFU signal converts the energy at the fundamental to harmonics and in the tissue (graph 2). In particular, the energy of the signal at frequencies that are different from the fundamental frequency f0 the HIFU signal (such as the frequency of one or more of the harmonics f1, f2, f3, etc.) changes in comparison to the energy of the signal at the fundamental frequency f0 as shown in graph 2. K values are calculated by combining the energies at these various frequencies as shown in graphs 3 a, b and c. For example, the energy in one or more of the harmonics may be compared to the fundamental frequency. The energy in several lower order harmonics and the fundamental may be compared to that of the high frequency harmonics. Alternatively, the energy in the fundamental may only be compared to that of the higher order harmonics. These graphs by no means exhaust the possibilities of combining and comparing the energies at the various frequencies. As will be appreciated by those skilled in the art, the value of K may vary depending on the range of frequencies or particular harmonics used in computing the numerator and denominator.
    Graph 4 shows that the K values may be graphed as a function of position. The ratio K may vary with the depth in the tissue as well as with different levels of transmit excitations. In one embodiment, the ratio K is expected to be a non-linear curve that increases with increasing depth in the tissue, but tends to reach a maximum (or saturate) at approximately the depth of the focal point of the HIFU signal. If K values are calculated after each transmit pulse (graph 5), then multiple K value curves may be generated as shown in graph 4.
    Graph 5 shows that the frequency of the transmit pulses may occur at the pulse repetition interval. FIGS. 10A-10C illustrate a pulse length and a pulse repetition interval in a burst. Many pulse lengths make up a burst. Each burst has a defined burst length, and the time between the start of each burst is the burst interval as shown in FIG. 10A. Each HIFU burst includes a number of HIFU pulses having a pulse length, where the time between the start of each pulse is the pulse rate interval as shown in FIG. 10B. The total time of the transmit excitation is the pulse length as shown in FIG. 10C. Each HIFU pulse is a sinusoidal waveform having a fundamental frequency f0.
    Returning to FIG. 9, a first curve 70 in graph 4 illustrates the ratio K for a first delivered energy level of the HIFU signal and a second curve 74 illustrates the ratio of K for a higher level of energy. By observing the changes in the K values as a function of depth, time, or transmit excitation, then a relative measure of the energy deposited spatially may be approximated.
    The energy of the HIFU signal can be modified by increasing or decreasing any of the burst length, the burst interval, the pulse length, the pulse rate interval, or other characteristics such as the pulse amplitude. In one embodiment, the HIFU treatment system automatically varies the acoustic output energy or power as a function of both the characteristic K curve relative to the baseline characteristic curve and whether the device is within an acceptable range for the values of K. An acceptable range for K may have an upper limit for pre-focal and focal values of K, based on safety levels. Other treatment parameters such as treatment time or pulse repetition frequency of the HIFU signals can be selected in a similar manner.
     FIGS. 1 through 10 illustrate an embodiment of the disclosed technology starting with a simple block diagram. As one trained in the art will appreciate, there are other versions of this technology that generate similar benefits. FIG. 11 is another block diagram of a HIFU treatment system for implementing the technology disclosed herein. In the embodiment, a HIFU controller 110 delivers electronic driving signals to an external or internal transducer probe 116 that in turn converts the driving signals into acoustic HIFU signals. In FIG. 11, the HIFU transducer probe 116 is shown in a wand-like apparatus. It is important to note that the HIFU transducer many have a plurality of elements in multiple dimensions that are mechanically or electronically steered to properly direct the ultrasound signal to the intended target. For example, the HIFU signals may be directed to a focal zone that is aimed at a target volume 118 through electronic or mechanical means. The target volume 118 may include all or a portion of a fibroid in a uterus 120. The HIFU signals create corresponding echo signals from tissue that are intercepted by the acoustic propagation. In most cases, the HIFU signal energy is concentrated on an axis that is located between the transducer probe 116 and the focal zone.
    The echo signals are received by the transducer probe 116, converted into an electronic form and supplied to the HIFU controller 110. The detection of the echo signals may take place in the HIFU transducer or another specially designed device contained within the transducer probe 116. Furthermore, the detection device may be in a separate holder not contained within the transducer probe 116.
    As previously described, the K values from the echo signals are calculated (FIG. 9), analyzed, and used to control or select one or more treatment parameters. An ultrasound processor 124 that is connected to or incorporated within the HIFU controller 110 analyzes the received echo signals and computes the K values. Based on the analysis, one or more treatment parameters or characteristics of the HIFU excitation signal (e.g., peak power, average power, pulse duration, pulse repetition interval, etc.) are automatically or semi-automatically adjusted by the ultrasound processor 124. In some cases, the operator may be alerted via an audible, visible, or tactile alert 130 to manually adjust one of the device parameters through a control on the device (e.g., main console control 112, applicator, footswitch). A safety mechanism to ensure treatment does not continue without proper feedback signals may also be employed. In some instances, the system may also include ultrasound imaging capabilities that produce images of the tissue on a video display 132. The images may be obtained with a separate or integrated imaging ultrasound transducer. These images may be used to confirm proper adjustment of the HIFU excitation characteristics.
    To estimate how much of the incident HIFU energy is being absorbed by the tissue at various positions at or adjacent to the focal point of the HIFU signal, the value of the ratio K is determined from the echo signals received from a given point in the tissue. In one embodiment, the ratio is compared to a desired value of K that was determined from prior testing. The value of the ratio K for the detected signals can therefore be used as a feedback signal to adjust one or more characteristics of the HIFU signal to affect absorption and hence HIFU effects on tissue at a given point. Detection of saturation (acoustic shock waves) or the slope of the increase in the K value as a function of the transmit excitation may also be used as feedback mechanisms to adjust one or more characteristics of the HIFU signal rather than depending on prior testing.
    In one embodiment, if the determined value of K for detected signals is below a threshold value for a particular position in the patient, then a signal characteristic such as the amplitude, peak or average power, duty cycle, pulse repetition rate, or other characteristic of the delivered HIFU signals can be electronically or manually increased to increase the ratio K at that position. Conversely, if the determined value of K is above a threshold, then one or more of the amplitude, power, duty cycle, pulse repetition rate, or other characteristic of the HIFU signal can be decreased to decrease the value of K. Different threshold values of K may be used to analyze echo signals received from within the target volume and outside that target volume in the body.
     FIGS. 12A and 12B illustrate two possible applicator configurations that deliver HIFU signals to a target volume and detect echo signals at the fundamental frequency of the HIFU signal and at harmonics or other frequencies. In the example shown in FIG. 12A, a HIFU transducer probe 200 delivers one or more HIFU signals to a target volume. The HIFU transducer probe may have a fixed or variable focal point. Echo signals are received by a separate receiving transducer 220. The receiving transducer 220 has a bandwidth that is sufficient to detect echo signals over a range of frequencies that may include the fundamental frequency of the HIFU signals produced by the transducer probe 200 and its harmonics. The receiving transducer 220 may be an ultrasound imaging transducer, a non-imaging transducer such as a polyvinylidene fluoride (PVDF) transducer, a fiber optic hydrophone or other form of hydrophone. The receiving transducer 220 may be positioned to detect echo signals reflected back from the focal point. Alternatively the receiving transducer 220 may be positioned to detect signals that are transmitted through the focal point and away from the HIFU transducer.
    In the example shown in FIG. 12B, a combination HIFU transmitting and receiving transducer probe 230 includes HIFU transmitting elements 232 that produce the HIFU signals and an array of higher bandwidth receiving elements 234 that are used to detect echo signals over a range of frequencies that may include the fundamental frequency of the HIFU signals and may also include one or more harmonics. The transducer in FIG. 12B may utilize a PVDF or other type of sensor.
     FIGS. 13A and 13B illustrate two different feedback mechanisms to adjust a treatment parameter of a HIFU signal to be delivered. In FIG. 13A, a control signal 239 from the HIFU controller 110 is applied to a waveform generator 240 to produce a waveform of the HIFU signals that will be applied to the patient. A control signal 249 is also applied to the waveform generator 240 by a signal processing unit 248 such as a programmable microprocessor or special purpose microprocessor within the ultrasound processor 224 that correlates the transmission and receipt of HIFU signals. Alternatively, the signal processing unit 248 may be a stand-alone device. The signals from the waveform generator 240 are supplied to a pulser 242 that increases the voltage of the signals to the level required by a HIFU transducer 244 to produce ultrasound acoustic signals. Echo signals are received by the HIFU transducer 244 where they are converted back into an electronic form for supply to a receiver 246. From the receiver 246, the echo signals are supplied to the signal processing unit 248 that analyzes the echo signals in accordance with the control to determine the ratio K described above. The signal processing unit 248 produces the control signal signals 249 that are fed back to the waveform generator 240 to electronically change one or more characteristics of the HIFU signals in order to change the energy or other characteristic of the HIFU signals delivered to the patient such that the detected ratio K falls within a desired range.
    The feedback mechanism shown in FIG. 13B is similar to that shown in FIG. 13A except that a separate transducer 245 is used to detect the echo or other (e.g. transmitted) signals from the patient. For example, the transducer 245 may be a high bandwidth single element transducer such as a transducer with a PVDF material, or it may be an imaging transducer. Echo or non-reflected signals received by the transducer 245 are supplied to the receiver 246 and the signal processing unit 248 that determines the value of the ratio K and what, if any, characteristics of the HIFU signals should be electronically adjusted to control the energy or other characteristic of the HIFU signals delivered to the patient.
    In yet another embodiment, the system includes an integrated or separate ultrasound imaging system that produces ultrasound images such as B-mode images of the tissue. The value of the ratio K is determined for various points in the body and is color coded or otherwise made visually distinct. The visually distinguished K values in the tissue can then be combined with a B-mode or other type of ultrasound image. In one embodiment, the color coded K values 134 are overlaid onto a B-mode image on the display 132 as shown in FIG. 11. By viewing the various levels of K, the physician can see where the higher frequency components of the HIFU signals are being created. The physician can then adjust the position of the HIFU transducer probe so that the HIFU signals are being delivered into the desired area. In addition or alternatively, the physician can see if one or more characteristics of the HIFU signals should be adjusted to change the amount of energy delivered to the patient.
    In another embodiment, the system may calculate the center of mass, also called a centroid, for use in the physician's on-screen display, by analyzing the harmonics received by the system. This reduces the overall clutter in the on-screen display.
    In another embodiment, the system records the value of the inputs that provide the K ratio value. This allows the system to detect a correlation between pulses in order to build a successive picture of trends in feedback characteristics. This may, for example, provide information valuable in determining whether cavitation or other tissue characteristics have occurred. The system may also make use of pulse inversion in order to create a data set of K ratio values over time for use in feedback analysis that eliminates the fundamental.
     FIG. 14 illustrates another embodiment of the disclosed technology where instead of calculating the value K by Fourier transform, a number of filters 300 detect the energy of the echo signals in various frequency ranges. The filters can be digital (e.g., FIR or IIR) or analog (e.g., bandpass, notch, etc.). The value K can then be determined digitally or with an analog circuit 302.
    Another possible embodiment of this technique is to use baseband detection along with low pass filtering to determine the energy in a detected signal at the fundamental as well as at one or more of the harmonics. The acquired rf vector at a particular power setting is detected and multiplied by sine and cosine waves at the fundamental or harmonic frequencies to obtain baseband data:
    B n(t)=x(t)*exp(−j2πnft)
    where f is either the fundamental frequency, n the order of the harmonic (e.g. n is one for the fundamental and 2 for the second harmonic), t is the time vector, x(t) is the original rf waveform, and B, is the baseband detected signal.
    After mixing with the sine and cosine waves, the signal is low pass filtered to eliminate energy from other harmonics. The bandwidth of the low pass filter is driven by the bandwidth of the original excitation. After the low pass filter, the signal may be decimated to a lower sampling frequency. The baseband detected signal is associated with a specific transmit power and is a function of depth.
    In addition or as an alterative to controlling treatment parameters based on the ratio of the energy in different frequency regions, other characteristics of the detected signals can also be used to select or control the treatment parameters.
     FIG. 15 shows an original ultrasound echo obtained from an in-vivo porcine subject in which a HIFU signal was targeted at 107 mm. FIGS. 16 and 17 show the baseband detected signals for the fundamental and second harmonic of the echo signal respectively. As more signals are acquired at different power levels, a filter may be applied over the ensemble of detected signals to reduce noise artifacts. Furthermore, additional filtering in depth and power dimension may be applied due to the expected transitions. FIG. 18 shows a 2D image of the second harmonic energy as a function of depth and excitation power. To select a treatment parameter such as the desired transmit power, a search region may be defined around the expected focus. The size of the search region will vary depending on the depth-of-field of the transducer and potential variances in propagation velocity.
    As will be described below, the response of a signal characteristic to changes in the power of a transmitted HIFU signal is used to select one or more treatment parameters of HIFU signals that will be used to treat a tissue site. FIG. 19 illustrates a response curve showing how the energy of a received signal at the second harmonic of the HIFU test signals varies with changes in HIFU power for a tissue area near the focal point of the transducer. Depending on how many test signals are used, the response curve would be created from a series of discrete data points obtained for different transmit powers that are then mathematically smoothed.
    In the example shown, the response curve shown in FIG. 19 is computed from received echo signals at the second harmonic of the HIFU transmit frequency. However it will be appreciated that the signal detected could be a signal that passes through the treatment site or could be computed for another harmonic or range of frequencies or combination of harmonics. In general, the response curve will be computed for a signal characteristic that exhibits a measurable change with changes in transmitted HIFU power.
    In one embodiment, to select the one or more treatment parameters to be used in treating a tissue site, the response curve for the tissue is determined using a number of test signals transmitted at different power levels. The response curve may be compared to previously known response curves having treatment parameters associated with them. The treatment parameters associated with the previously known response curve that best matches the response curve for the tissue site in question can be used to treat the tissue site. Alternatively, one or more points on the response curve for the tissue can by analyzed to select the one or more treatment parameters.
    In one embodiment, the response curves can be analyzed to determine a saturation point, slope or other characteristic such as the shape of the curve. FIG. 19 shows a saturation point for the second harmonic signal near the focus with a power saturation value of approximately 1500 W. The treatment parameters associated with a 1500 watt saturation point can therefore be used to treat the tissue.
    To automate the determination of the saturation levels in the focal region the response curve is analyzed with a suitably programmed processor or computer. In one embodiment, the goal is to identify the power which exhibits the highest level of scattered energy and thus energy absorption. Ideally regions with significant amounts of harmonic energy would be used to maximize signal-to-noise ratio. For example, the peaks throughout the search region may be selected rather than each sample.
    In one embodiment, a look-up-table (LUT) of expected response curves is used to determine the saturation values around the focus. This LUT may consist of response curves predicted theoretically with different characteristics such as attenuation and isentropic non-linearity parameter B/A. Statistical techniques such as correlation are used to compare the theoretical curves to the detected response curve. In this case, it is possible to obtain the saturation power as well as the effective characteristics of the tissue path such as attenuation that can be used to determine the length of treatment time to treat the tissue site.
    In another embodiment, the processor or computer is programmed to determine the first and second derivatives of the determined response curve. Next, regions that are concave down with both positive and negative slopes on either side are identified and considered the saturation value.
    In yet another embodiment, the expected first and second derivatives are used to code the waveform at a particular depth. Rather than look for a place that has a slope of zero and is concave down, the processor or computer is programmed to use other characteristics of the expected curve predicted by theory or other controlled experiments to increase the confidence that the correct saturation value was chosen. A code is assigned to the expected waveform and the code of the experimental data is determined based on the sign of the first and second derivative. For example, a code of zero is assigned to a slope of zero, a code of one to a negative slope and code of two to a positive slope. In this case, each point analyzed on the response curve could have one of nine possible codes (e.g. 00, 01, 02, 10, 11 etc.). The code is modified only if there is a change between the value of the first and second derivatives between samples, which further compresses the data. A correlation value may be determined between the coded expected value and the coded experimental value to increase the reliability of the algorithm. If the correlation is not above a certain value, then the saturation cannot be determined.
    In some embodiments, the curve with the lowest saturation value is used as the prediction. Another method is to average the results through the search region and utilize this for treatment. Ideally, the process for determining the saturation value occurs in real-time such that exorbitant power values are not used.
    This idea may be extended to lesions at different depths. In this case, interrogations at different lesion locations are completed. The estimated saturation levels are compared. This allows for the possible calculation of the effective attenuation in the treatment region.
    In yet another alternative embodiment of the disclosed technology, the response curve for the detected signals that is analyzed to determine the treatment parameters is related to the temperature change at the focal zone. In this case, HIFU test signals are transmitted and a change in temperature is determined based a detected speckle shift of a reflected signal (echo) or transmitted signal. Speckle shifts are determined for a number of HIFU signals transmitted at different power levels in order to generate the response curve. Preferably the test HIFU signals are sufficiently short so that the tissue in the focal zone does not undergo sustained heating prior to treatment or between test signals. The response curve is analyzed by comparing against predetermined response curves or by determining some characteristic such as its saturation point, whereby the speckle shift no longer increases or decreases with increases in delivered HIFU signal power. Once the response curve has been analyzed either by comparison to previously determined response curves or by analyzing selected points on the response curve, the treatment parameters can be selected.
    In yet another alternative embodiment, a response curve related to the dispersion of the waveform transmitted into the tissue is used to control or select the treatment parameter for the HIFU signals to be used to treat the target tissue site.
    Dispersion occurs in acoustic waves and is noted by a slight velocity difference of the wavefront that is a function of frequency although the group velocity may remain constant. In high intensity acoustics, dispersion in the wave pulse naturally occurs in regions of high compression due to the production of harmonics. The high pressure and non-linearities of tissue eventually lead to acoustic shock at the highest compressional pressures. The production of harmonics and dispersion are less likely to occur in low pressure pulses. As the pressure is increased, the amount of dispersion increases since harmonics are more easily generated. This dispersion is detected as a phase shift in the waveform as the amplitude of the excitation moves from low pressure to high pressure. The dispersion is seen as movement of the rf signal toward the transducer and is localized by the area of high pressure. This is unique when compared to other effects such as acoustic radiation force (ARF) and apparent phase shifts due to temperature changes. In both of these cases, the expectation is the phase shift is away from the transducer. Furthermore, velocity changes due to temperature are an integrative effect in tissue. In other words, where the local temperature has increased, the shift will appear at that point as well as for every point behind the thermal increase.
     FIG. 20 shows the changes that occur in the pressure pulse at the focus at increasing transmit pressures 400, 402, 404, 406. Each pulse has been normalized for purposes of illustration. In this case, the fiber optic pressure hydrophone (FOPH) is receiving the transmitted pulse at the focus (in this case 64 mm). The high compressional pressure produces the shock that appears between 2.9 usec and 3.1 usec in FIG. 20. As the pressure is increased, the shock front is produced prior to the focus which yields to the detected dispersion at the focus. FIG. 20 captures the movement of the compression peak from a low excitation level (400) to a high excitation level (406). In this case, the movement is approximately 0.1 usec. FIG. 21 shows the received echo from a point target at the focus at the same transmit power levels 400, 402, 404, 406. The PVDF sensor shows dispersion occurring for negative as well as positive pressures. This is due to the PVDF sensor impulse response. When a wide bandwidth wavefront such as that shown in FIG. 21 impinges the PVDF sensor surface, the sensor will mechanically vibrate equally in compression and rarefaction.
    The resulting phase shifts shown in FIGS. 20 and 21 are detected as a spatial shift in an ultrasound image. This spatial shift may be detected on rf as well as detected data. Furthermore, the detected phase shift may be used to localize areas of high pressure. Therefore, it is possible to create a pressure map of the body based on dispersion.
    Dispersion may be detected as a slight shift in the image or speckle toward the HIFU transducer as test signals of successively higher power are applied to the tissue. This is illustrated in FIGS. 20 and 21 in which the higher level DAQ settings correspond to higher power levels and the time to receive the wavefront corresponds to its position relative to the transducer.
    As the power level is increased, there is a corresponding increase in production of harmonics at the focal region—which in turn reduces the time to receive the signal scattered from the focal region, due to dispersion. This reduced time can be perceived as a spatial shift in the ultrasound image towards the transducer, assuming the signals are displayed graphically.
    As shown in the attached flowchart of FIG. 22, to determine a treatment parameter such as a power level setting for HIFU to be delivered to a tissue treatment site, a therapy transducer is briefly excited at a number of test power level settings. At each such setting, a backscattered ultrasound signal is detected with the same transducer that delivers the signals or with a different transducer. The backscattered signals are stored until each of the possible power levels are tested or until an optimal power level is determined.
    After delivering the test signals with the different power level settings, the speckle shift associated with adjacent power level settings is determined. A response curve showing the change in the speckle shift versus changes in HIFU power is created with a programmed processor or computer. The response curve is analyzed and used to select one or more treatment parameters. For example, a programmed processor can analyze the response curve to determine a power level at which the speckle shift saturates i.e. doesn't change with further increases in power or the amount of speckle shift decreases with further increased power. In one embodiment, the treatment parameters are selected based on the power level of the HIFU that causes saturation. Other signals characteristics such as the slope of the response curve can be used to select the treatment parameters. In yet another alternative embodiment, the response curve can be compared with predefined response curves having treatment parameters associated with them. The treatment parameters associated with the response curve that best matches the determined response curve can be used to treat the tissue.
    In one embodiment, treatment of each location within an intended treatment volume may be immediately preceded by determination of the treatment parameters for that location. In another embodiment, the treatment parameters may be determined at a variety of locations within an intended treatment volume prior to commencing treatment of any such location. The treatment parameters for each location are then stored in a memory or other computer readable media. Once treatment begins, the selected treatment parameters are recalled for each such location and used to treat that location. In yet another embodiment, the treatment parameters selected for one location can be used to treat an entire volume of tissue.
    To maximize the accuracy and consistency of this method for selecting treatment parameters, the successive test HIFU signals should be spaced together closely in time so as to minimize any spatial shifts that might occur due to tissue motion (e.g. due to breathing or other patient motion).
    In addition, the test signals should be applied in a manner which minimizes local heating of tissue, so as to avoid shifts that might occur due to changes in local sound velocity.
    In yet another embodiment, the energy in a received signal at harmonics of the fundamental frequency of the HIFU signal can be estimated by measuring the energy at the fundamental frequency. This technique allows a more narrow band detection system to be used.
    If a HIFU signal is delivered to the tissue at power P1 (that is selected to be low enough not to create energy at the harmonics in the tissue) and at a distance r, the HIFU signal will produces a signal with energy at the fundamental frequency of the HIFU signal that is defined by a function:
   Xf (P1,r)   (6)
    If the tissue behaved linearly, then the energy at the fundamental of a signal created from a HIFU signal that is transmitted at a higher power level P2, should be related to the different power level by the function:
  







Xf


(


P


 


2

,
r

)


=



P


 


2


P


 


1




Xf


(


P


 


1

,
r

)







(
7
)







    However the tissue generally does not respond linearly to higher power levels of HIFU signals. Therefore the measured energy at the fundamental frequency of a signal that is created in response to a higher power HIFU signal will differ from the prediction. The difference is related to the energy that is being converted into the energy at the harmonics.
    To estimate the energy at the harmonics, the energy of a received signal at the fundamental frequency of the HIFU signal that is delivered at a power level P2 is determined. The difference between the energy measured and the energy predicted is calculated. according to the function:
  






Xh
=




P


 


2


P


 


1


*

Xf


(


P


 


1

,
r

)



-

Xf


(


P


 


2

,
r

)







(
8
)







    where Xh is the energy at the harmonics. The ratio of the energy in the harmonics to the energy at the fundamental frequency of the HIFU signals is therefore given by the function:
  








Xh


(


P


 


2

,
r

)



Xf


(


P


 


2

,
r

)



=





P


 


2


P


 


1




Xf


(


P


 


1

,
r

)




Xf


(


P


 


2

,
r

)



-
1





(
9
)







    A response curve can therefore be created that relates the energy of the harmonics to increases in the energy of the HIFU signals delivered. The response curve can be analyzed by a programmed processor or computer and used to select the treatment parameters either by comparison against predetermined response curves having treatment parameters associated therewith or by analyzing characteristics of the response curve and selecting treatment parameters associated with the characteristics.
    In yet another embodiment, the “focal gain” i.e. the increased energy absorption caused by the energy level of the harmonics that is created in the tissue can be estimated by comparing the energy of the signals created from HIFU signals at different powers. If the tissue were linear, then the following relationship should hold for different HIFU power levels.
  








X


(


P


 


2

,
r

)





P


 


2


P


 


1




X


(


P


 


1

,
r

)




=
1




(
10
)







    However as the power level increases, more energy is transferred to the harmonics and the ratio should become less than one with a drop in the detected energy at the HIFU power level that causes a saturation if measured with a narrow band receiver or a gain in the detected energy at the energy level that causes saturation if measured with a wide band receiver. Therefore, a response curve can be determined that relates the ratio of detected energy to predicted energy at several different HIFU power levels. The response curve can then be analyzed or compared to other response curves in order to select one or more treatment parameters.
    As will be appreciated by those skilled in the art, the deposition of energy at a treatment site is effected by the tissue's “alpha” value that is related to attenuation as well as its “B/A” value that is related to the tissue's isentropic non-linearity parameter B/A.
    The alpha value for the tissue treatment site can be estimated by measuring the energy of a signal created in response to a test HIFU signal at a fixed power. The transducer can then be moved away from the treatment site and the space filled with a medium of known attenuation e.g. water. A second test HIFU signal is then applied to the tissue and the energy detected. A response curve in this example therefore relates the difference in energies detected and the distance that the transducer was moved. From the estimated attenuation of the tissue, a treatment regimen (power and treatment duration or other treatment parameter) can be selected based on predetermined clinical data performed on tissue types with similar alpha values. The alpha value for the tissue can be determined by comparing response curves for different spatial locations in the tissue.
    The B/A value for a tissue site to be treated can be estimated based on comparison of the tissue's response curve with response curves computed for tissue types with known B/A values.
    As indicated above, the treatment parameters such as power level, pulse duration, pulse repetition frequency etc. are selected based on an analysis of the response of the tissue to be treated to a HIFU pulse. The particular values for these treatment parameters will be based on clinical data and stored in a manner that can be indexed based on an analysis of the response curve for the treatment site. The parameter data is typically stored in a computer readable media, hard drive, CD ROM, solid state memory etc, that is accessed by a local or remote computer. When needed, the recalled treatment parameters are applied to the HIFU control hardware so that the tissue can be treated.
    In addition or as an alternative to selecting or adjusting the energy of the delivered HIFU signals, the disclosed technology can be used to redirect the focus point of the delivered signals. In the embodiment shown in FIG. 23, a therapy transducer 350 delivers a number of test signals to a tissue site at the same or different power levels. A detection transducer 352 receives the corresponding echo or other signals, which are provided to a processor (not shown) that computes response curves, such as the K values described above or response curves based on other signal characteristics, at a number of positions in the tissue. In the example shown, the K values have a maximum value at a point 360 which is offset from an intended focus point 362 of the test signals. By comparing the location of the maximum K value to the intended focus point, the processor can determine if the focus point is misaligned. By computing the offset between the location of the maximum K value at 360 and the intended focus point at 362, a difference vector can be determined and the difference vector supplied to a beam forming equation used by a waveform generator to cause the therapy transducer 350 to redirect the focus point of the HIFU process towards the desired focus point 362. Alternatively, the difference vector can be supplied to a mechanical mechanism (not shown) that physically reorients the focus of the HIFU transducer. The process can continue by continuing to measure K values from the received echo signals and computing the location of the maximum K value and comparing it to the desired focus point until such time as the maximum K value is within a predetermined distance of the desired focus point.
    If the response curves are created based on other signal characteristics, the focus can be redirected based on the response curves determined for each of the spatial locations.
    Although illustrative embodiments of the disclosed technology have been illustrated and described, it will be appreciated that various changes can be made therein without departing from the scope of the technology. For example, the response curves may also be produced for a change in acoustic radiation force (ARF) that relates movement of the tissue to changes in power of the test signals. In addition, the disclosed technology is not limited to the delivery of HIFU signals to the patient but can be applied to the delivery of any waveform such as non-focused ultrasound to a non-linear medium such as tissue. Therefore, the scope of the technology is to be determined solely by the following claims and equivalents thereof.

1. A method of operating a high intensity focused ultrasound (HIFU) system to treat a target treatment site by:
transmitting one or more test signals into a tissue site; detecting signals from the area of the tissue site that are created by the one or more test signals; determining a response curve for the tissue site that indicates how a signal characteristic of the detected signals changes in response to the one or more test signals; and using the determined response curve to select a treatment parameter of the HIFU signals that will be used to treat the target treatment site and applying HIFU signals with the selected treatment parameter to the target treatment site with the HIFU system. 

  
 2. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels with a fundamental frequency and the response curve relates how an energy level of a detected signal at a harmonic of the fundamental frequency varies with different power levels.

  
 3. The method of claim 1, wherein the response curve relates how an energy level of a detected signal in two different frequency ranges varies with depth in the tissue site.

  
 4. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels with a fundamental frequency and the response curve relates how an energy level of a detected signal at the fundamental frequency varies with different power levels.

  
 5. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how an energy level of a detected signal at two different frequency ranges varies with different power levels.

  
 6. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how an energy level of a detected signal in a range of frequencies varies with different power levels.

  
 7. The method of claim 1, wherein response curve is used to select the treatment parameter by determining a closest match of the response curve to a number of predetermined response curves each having a treatment parameter associated therewith, and selecting the treatment parameter associated with the predetermined response curve that best matches the response curve of the detected signal.

  
 8. The method of claim 1, wherein response curve is used to select the treatment parameter by determining a characteristic of the response curve and selecting a treatment parameter associated with the characteristic.

  
 9. The method of claim 8, wherein the characteristic of the response curve is a saturation point of the response curve.

  
 10. The method of claim 8, wherein the characteristic of the response curve is a shape of the response curve.

  
 11. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how a dispersion of a detected signal varies with different power levels.

  
 12. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how a speckle shift related to changes in temperature at the target treatment site varies with different power levels.

  
 13. The method of claim 1, wherein the test signal includes two or more test signals transmitted at different power levels and each test signal transmitted at the same power level includes a pair of test signals having opposite phases.

  
 14. A high intensity ultrasound (HIFU) system to treat tissue at a target treatment site, comprising:
an ultrasound transducer that is configured to deliver a test signal and HIFU signals to a tissue site; a controller that is configured to control the ultrasound transducer to deliver HIFU signals to the target treatment site with a selectable treatment parameter; a receiver that is configured to detect signals from the tissue site created by the one or more test signals; and a processor programmed to analyze the detected signals to determine a response curve for the tissue site that indicates how a signal characteristic of the detected signals changes in response to the test signal, wherein the processor is programmed to select a treatment parameter for the HIFU signals to be used in treating the target treatment site based on the response curve determined. 

  
 15. The system of claim 14, wherein the test signal includes two or more test signals transmitted at different power levels with a fundamental frequency and the response curve relates how an energy level of a detected signal at a harmonic of the fundamental frequency varies with different power levels.

  
 16. The system of claim 14, wherein the response curve relates how an energy level of a detected signal in two different frequency ranges varies with depth in the tissue site.

  
 17. The system of claim 14, wherein the test signal includes two or more test signals transmitted at different power levels with a fundamental frequency and the response curve relates how an energy level of a detected signal at the fundamental frequency varies with different power levels.

  
 18. The system of claim 14, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how an energy level of a detected signal at two different frequency ranges varies with different power levels.

  
 19. The system of claim 14, wherein the processor is programmed to select the treatment parameter by determining a closest match of the response curve to a number of predetermined response curves each having a treatment parameter associated therewith, and selecting the treatment parameter associated with the predetermined response curve that best matches the response curve of the detected signal.

  
 20. The system of claim 14, wherein processor is programmed to select the treatment parameter by determining a characteristic of the response curve and selecting a treatment parameter associated with the characteristic.

  
 21. The system of claim 20, wherein the characteristic of the response curve is a saturation point of the response curve.

  
 22. The system of claim 20, wherein the characteristic of the response curve is a shape of the response curve.

  
 23. The system of claim 14, wherein the test signal includes two or more test signals transmitted at different power levels and the response curve relates how a dispersion of the detected signal varies with different power levels.

  
 24. The system of claim 14, wherein the test signal includes two or more test signals transmitted at different power levels and each test signal transmitted at the same power level includes a pair of test signals having opposite phases.

  
 25. The system of claim 14, wherein the receiver is a HIFU transducer.

  
 26. The system of claim 14, wherein the receiver is an ultrasound imaging transducer.

  
 27. The system of claim 14, wherein the receiver is a PVDF transducer.

  
 28. The system of claim 14, wherein the receiver is a hydrophone.

  
 29. The system of claim 14, wherein the processor is programmed to produce a signal to adjust the treatment parameter.

  
 30. The system of claim 29, wherein the signal is perceptible by a human to manually adjust the treatment parameter.

  
 31. The system of claim 27, wherein the signal is used in a feedback loop of the HIFU system to dynamically adjust the treatment parameter.

  
 32. The system of claim 14, wherein processor is programmed to select the treatment parameter by comparing characteristics on the response curve to threshold values.

  
 33. A system for applying HIFU signals to a subject, comprising:
a HIFU controller that produces electronic HIFU driving signals having one or more adjustable characteristics that affect the energy of a delivered HIFU signal; a HIFU transducer that receives the electronic HIFU driving signals and produces acoustic HIFU signals with a fundamental frequency and applies the acoustic HIFU signals to tissue of the subject; a receiving transducer that detects echo signals from the tissue of the subject; and a processor that receives the echo signals and compares the energy of the echo signals in a first frequency range to the energy of the echo signals in a second frequency range at a number of locations in the tissue; and a display on which an image of the tissue is displayed along with an image representative of the comparison at one or more locations in the tissue. 

  
 34. The system of claim 33, wherein the processor compares the energy of the echo signals in the first frequency range to the power of the echo signals in the second frequency range by computing a ratio of the power of the echo signals in the first frequency range to the power of the echo signals in the second frequency range and quantifies the ratio in a visually or audibly perceptible form.

  
 35. The system of claim 33, wherein the visually perceptible form is a color code.

  
 36. A method of adjusting a focal location of a HIFU transducer comprising:
transmitting test signals at different power levels into tissue at an intended focal location; receiving echo signals at a number of spatial locations in the tissue that are created by the test signals; determining response curves for the tissue at each of the spatial locations that indicate how a signal characteristic of the echo signals changes with changes in power of the test signals; analyzing the response curves to determine an estimate of an actual focal location; and adjusting the intended focal location based on the estimate of the actual focal location. 

  
 37. A method of claim 36, wherein the adjustment is performed successively until a minimum required difference between the estimated actual focal location and intended focal location is achieved.

  
 38. A method of claim 36, wherein the adjustment is performed successively until a maximum number of iterations is achieved.

  
 39. A high intensity ultrasound (HIFU) system to treat tissue at a target treatment site, comprising:
an ultrasound transducer that is configured to deliver a number of test signal at different power levels; a controller that is operable to adjust the focal location of the ultrasound transducer; a receiver that is configured to detect echo signals at a number of spatial locations created by the number of test signals; and a processor programmed to analyze the detected signals to determine a response curve that indicates how a signal characteristic of the detected signals changes in response to the test signal at the spatial locations, wherein the processor is programmed to cause the controller to adjust the focal location of the ultrasound transducer based on the determined response curves. 

  
 40. A method of adjusting a focal location of an ultrasound transducer, comprising:
transmitting an ultrasound signal into tissue at an intended focal location with a first transducer; receiving echo signals from the tissue with a second transducer; determining the energy of the received echo signals in a first frequency range and a second frequency range; determining a location of a maximum difference in the energy in the first and second frequency ranges as an estimate of an actual focal location; and adjusting the intended focal location based on the estimate of the actual focal location. 

  
 41. A high intensity ultrasound (HIFU) system to treat tissue at a target treatment site, comprising:
an ultrasound transducer that is configured to deliver a test signal to a tissue site at an intended focal location; a controller that is operable to adjust the focal location of the ultrasound transducer; a receiver that is configured to detect echo signals at a number of spatial locations in the tissue site; and a processor programmed determine a response curve indicative of the energy of the received echo signals in a first frequency range and a second frequency range for the spatial locations, wherein the processor determines a location of a maximum difference in the energy in the first and second frequency ranges as an estimate of an actual focal location and to cause the controller to adjust the intended focal location based on the estimate of the actual focal location.
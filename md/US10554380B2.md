Source: [US10554380B2](https://patents.google.com/patent/US10554380B2)

# [US10554380B2](US10554380B2.md) - [US10554380B2](US10554380B2.md) - Dynamically weighted exclusive or gate having weighted output segments for phase detection and phase interpolation

## Details

* Date: 2018-01-26
* Inventor: Kandou Labs SA
* Beneficiary: Armin Tajalli

## Other patents

### Backwards
 * US668687A
 * US780883A
 * US3196351A
 * US3636463A
 * US3939468A
 * US4163258A
 * US4181967A
 * US4206316A
 * US4276543A
 * US4486739A
 * [US4499550A](US4499550A.md)
 * US4722084A
 * US4772845A
 * US4774498A
 * US4839907A
 * US4864303A
 * US4897657A
 * [US4974211A](US4974211A.md)
 * US5017924A
 * US5053974A
 * [US5166956A](US5166956A.md)
 * US5168509A
 * US5266907A
 * US5283761A
 * US5287305A
 * US5311516A
 * US5331320A
 * [US5412689A](US5412689A.md)
 * US5449895A
 * US5459465A
 * US5461379A
 * US5510736A
 * US5511119A
 * US5528198A
 * US5553097A
 * US5566193A
 * EP0740423A2
 * US5599550A
 * US5602884A
 * US5626651A
 * US5629651A
 * US5659353A
 * US5727006A
 * US5748948A
 * US5802356A
 * [US5825808A](US5825808A.md)
 * US5856935A
 * US5875202A
 * US5945935A
 * US5949060A
 * US5982954A
 * US5995016A
 * [US6005895A](US6005895A.md)
 * US6026134A
 * [US6084883A](US6084883A.md)
 * US6119263A
 * US6172634B1
 * US6175230B1
 * US6232908B1
 * US20010006538A1
 * [US6278740B1](US6278740B1.md)
 * US6307906B1
 * US6316987B1
 * US20010055344A1
 * US6346907B1
 * US20020034191A1
 * US20020044316A1
 * US6378073B1
 * US6380783B1
 * US6384758B1
 * US6389091B1
 * US20020057592A1
 * US6398359B1
 * US6404820B1
 * US6417737B1
 * US6433800B1
 * [US6452420B1](US6452420B1.md)
 * US20020154633A1
 * US6473877B1
 * US20020163881A1
 * US20020167339A1
 * US6483828B1
 * US20020174373A1
 * US20020181607A1
 * US20030001557A1
 * US6509773B2
 * US20030016770A1
 * US20030016763A1
 * US6522699B1
 * US20030046618A1
 * [US6556628B1](US6556628B1.md)
 * US20030085763A1
 * US6563382B1
 * JP2003163612A
 * US20030146783A1
 * US6621427B2
 * US20030174023A1
 * US6624699B2
 * US20030185310A1
 * US6650638B1
 * US20030218558A1
 * [US6661355B2](US6661355B2.md)
 * US6664355B2
 * US6690739B1
 * US20040027185A1
 * US6717478B1
 * US20040092240A1
 * [US6766342B2](US6766342B2.md)
 * US20040146117A1
 * US6772351B1
 * US20040155802A1
 * US20040161019A1
 * US20040169529A1
 * [US6839429B1](US6839429B1.md)
 * US6839587B2
 * WO2005002162A1
 * US20050024117A1
 * US6854030B2
 * US6865236B1
 * US6865234B1
 * US20050063493A1
 * US6876317B2
 * US20050084050A1
 * US20050117404A1
 * US20050128018A1
 * US20050134380A1
 * US6927709B2
 * US20050174841A1
 * US20050195000A1
 * US20050201491A1
 * CN1671092A
 * US20050213686A1
 * US20050220182A1
 * [US6954492B1](US6954492B1.md)
 * US6963622B2
 * US6973613B2
 * US6972701B2
 * US20050270098A1
 * US6976194B2
 * US20050275470A1
 * [US6990138B2](US6990138B2.md)
 * US6993311B2
 * [US6999516B1](US6999516B1.md)
 * US20060036668A1
 * US7023817B2
 * US7039136B2
 * US20060097786A1
 * US20060103463A1
 * US7053802B2
 * US20060120486A1
 * US20060126751A1
 * US20060133538A1
 * US20060140324A1
 * US7080288B2
 * US20060159005A1
 * US7082557B2
 * US7085153B2
 * US20060192598A1
 * US20060233291A1
 * US20060232461A1
 * US7127003B2
 * CN1864346A
 * [US7142612B2](US7142612B2.md)
 * US7142865B2
 * US20060291589A1
 * US20070001713A1
 * US20070001723A1
 * US20070002954A1
 * US7164631B2
 * US7167019B2
 * US20070030796A1
 * US7176823B2
 * [US7180949B2](US7180949B2.md)
 * US20070047689A1
 * US7199728B2
 * US20070076871A1
 * US20070103338A1
 * US20070121716A1
 * US7231558B2
 * US20070147559A1
 * US20070182487A1
 * US20070201597A1
 * US20070204205A1
 * US20070201546A1
 * US7269212B1
 * US7269130B2
 * US20070263711A1
 * US20070283210A1
 * US20080007367A1
 * US20080012598A1
 * US7335976B2
 * US7336112B1
 * US7339990B2
 * US7346819B2
 * US7348989B2
 * US7356213B1
 * US7358869B1
 * US7362697B2
 * US7366942B2
 * US20080104374A1
 * US7370264B2
 * US7372390B2
 * EP1926267A1
 * [US7389333B2](US7389333B2.md)
 * US20080159448A1
 * US7397302B2
 * US20080165841A1
 * US7400276B1
 * US20080192621A1
 * US7462956B2
 * US20080317188A1
 * US7496162B2
 * US20090059782A1
 * EP2039221A1
 * US20090103675A1
 * US20090115523A1
 * US7535957B2
 * US7539532B2
 * US20090154604A1
 * US20090167389A1
 * CN101478286A
 * WO2009084121A1
 * US20090195281A1
 * US7599390B2
 * US20090262876A1
 * US7613234B2
 * US7616075B2
 * US7620116B2
 * [US7633850B2](US7633850B2.md)
 * US20090316730A1
 * US7639596B2
 * US20090323864A1
 * US7650525B1
 * US7656321B2
 * US20100046644A1
 * WO2010031824A1
 * US7688929B2
 * US20100081451A1
 * US7694204B2
 * US7697915B2
 * US7698088B2
 * US7706524B2
 * US7706456B2
 * US20100148819A1
 * US20100180143A1
 * US7768312B2
 * US20100215087A1
 * US20100215112A1
 * US7787572B2
 * US20100220828A1
 * US20100235673A1
 * US7804361B2
 * US7808456B2
 * US20100271107A1
 * US20100283894A1
 * US20100296556A1
 * US7841909B2
 * US20100309964A1
 * US7860190B2
 * US20110002181A1
 * US7869497B2
 * US7869546B2
 * US20110014865A1
 * US7882413B2
 * US20110028089A1
 * US20110032977A1
 * US7899653B2
 * US20110051854A1
 * US20110072330A1
 * US20110074488A1
 * US20110084737A1
 * US7933770B2
 * US20110103508A1
 * US20110156757A1
 * US8000664B2
 * US20110228864A1
 * WO2011119359A2
 * US8030999B2
 * US8036300B2
 * US8050332B2
 * US20110268225A1
 * US8055095B2
 * US8064535B2
 * [US20110299555A1](US20110299555A1.md)
 * US20110302478A1
 * US20110311008A1
 * US8085172B2
 * US20110317559A1
 * US8106806B2
 * US8149906B2
 * US20120082203A1
 * [US8159376B2](US8159376B2.md)
 * US8180931B2
 * US8185807B2
 * US20120133438A1
 * US8199863B2
 * US8199849B2
 * US20120152901A1
 * US20120161945A1
 * US8218670B2
 * US8233544B2
 * US8245094B2
 * US20120206177A1
 * US20120213299A1
 * US8253454B2
 * US8279745B2
 * US8279094B2
 * US20120257683A1
 * US8289914B2
 * US8295250B2
 * US8295336B2
 * US8310389B1
 * US8341492B2
 * US20120327993A1
 * US20130010892A1
 * US20130013870A1
 * US8359445B2
 * US8365035B2
 * US8406316B2
 * US20130091392A1
 * US20130088274A1
 * US8429492B2
 * US8429495B2
 * US20130106513A1
 * US8437440B1
 * US20130114519A1
 * US20130114663A1
 * US8443223B2
 * US8442099B1
 * US20130129019A1
 * US20130147553A1
 * US8472513B2
 * US20130188656A1
 * US8498368B1
 * US20130195155A1
 * US20130202065A1
 * US20130207706A1
 * US20130215954A1
 * US8520348B2
 * US8547272B2
 * US20130259113A1
 * US20130271194A1
 * US20130285720A1
 * US8578246B2
 * US8588254B2
 * US20130307614A1
 * US8593305B1
 * US20130314142A1
 * US20130315501A1
 * US8604879B2
 * US8602643B2
 * US20130346830A1
 * US8620166B2
 * US8638241B2
 * US8643437B2
 * US8649460B2
 * US8674861B2
 * US8687968B2
 * US8718184B1
 * US20140159769A1
 * US8755426B1
 * CN203675093U
 * US20140177696A1
 * US8773964B2
 * US8782578B2
 * US8780687B2
 * US8791735B1
 * US8831440B2
 * US20140266440A1
 * US20140269130A1
 * US8841936B2
 * US20140286381A1
 * US8879660B1
 * US8898504B2
 * US8938171B2
 * US8951072B2
 * US20150049798A1
 * US8975948B2
 * US20150070201A1
 * US20150078495A1
 * US20150078479A1
 * US8989317B1
 * US20150117579A1
 * US9036764B1
 * US20150146771A1
 * US9059816B1
 * US20150180642A1
 * US9069995B1
 * US9077386B1
 * US9083576B1
 * US9093791B2
 * US9100232B1
 * US20150220472A1
 * US9124557B2
 * US20150249559A1
 * US20150256326A1
 * US9148198B1
 * US9148087B1
 * US9152495B2
 * US9172412B2
 * US9178503B2
 * US9183085B1
 * US20150333940A1
 * US9197470B2
 * US20150349835A1
 * US20150380087A1
 * US20150381232A1
 * US20160020796A1
 * US20160020824A1
 * US20160036616A1
 * US20160056980A1
 * US9281785B2
 * [US9288082B1](US9288082B1.md)
 * US9292716B2
 * US9300503B1
 * US9306621B2
 * US9331962B2
 * US20160134267A1
 * US9374250B1
 * US9397868B1
 * US9432298B1
 * US9438409B1
 * US20160261435A1
 * US9455744B2
 * US9455765B2
 * US9479369B1
 * US9520883B2
 * US9565036B2
 * [US9577815B1](US9577815B1.md)
 * US9634797B2
 * US20170310456A1
 * US20170317855A1
 * US20170317449A1
 * [US9906358B1](US9906358B1.md)
 * US9960902B1
 * US10055372B2
 * US20180375693A1
### Forward
 * 
## Abstract

Abstract

Methods and systems are described for receiving a reference clock signal and a phase of a local oscillator signal at a dynamically-weighted XOR gate comprising a plurality of logic branches, generating a plurality of weighted segments of a phase-error signal, the plurality of weighted segments including positive weighted segments and negative weighted segments, each weighted segment of the phase-error signal having a respective weight applied by a corresponding logic branch of the plurality of logic branches, generating an aggregate control signal based on an aggregation of the weighted segments of the phase-error signal, and outputting the aggregate control signal as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.



Methods and systems are described for receiving a reference clock signal and a phase of a local oscillator signal at a dynamically-weighted XOR gate comprising a plurality of logic branches, generating a plurality of weighted segments of a phase-error signal, the plurality of weighted segments including positive weighted segments and negative weighted segments, each weighted segment of the phase-error signal having a respective weight applied by a corresponding logic branch of the plurality of logic branches, generating an aggregate control signal based on an aggregation of the weighted segments of the phase-error signal, and outputting the aggregate control signal as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.

REFERENCES
The following prior applications are herein incorporated by reference in their entirety for all purposes:
U.S. patent application Ser. No. 15/494,439, filed Apr. 21, 2017, naming Armin Tajalli, entitled “High Performance Phase Locked Loop”, hereinafter identified as [Tajalli I].
U.S. patent application Ser. No. 15/602,080, filed May 22, 2017, naming Armin Tajalli, entitled “Data-Driven Phase Detector Element for PLL”, hereinafter identified as [Tajalli II].
FIELD OF THE INVENTION
The present embodiments relate to communications systems circuits generally, and more particularly to utilization of a Phase-Locked Loop to obtain a stable, correctly phased receiver clock signal from a high-speed multi-wire interface used for chip-to-chip communication.
BACKGROUND
In modern digital systems, digital information has to be processed in a reliable and efficient way. In this context, digital information is to be understood as information available in discrete, i.e., discontinuous values. Bits, collection of bits, but also numbers from a finite set can be used to represent digital information.
In most chip-to-chip, or device-to-device communication systems, communication takes place over a plurality of wires to increase the aggregate bandwidth. A single or pair of these wires may be referred to as a channel or link and multiple channels create a communication bus between the electronic components. At the physical circuitry level, in chip-to-chip communication systems, buses are typically made of electrical conductors in the package between chips and motherboards, on printed circuit boards (“PCBs”) boards or in cables and connectors between PCBs. In high frequency applications, microstrip or stripline PCB traces may be used.
Common methods for transmitting signals over bus wires include single-ended and differential signaling methods. In applications requiring high speed communications, those methods can be further optimized in terms of power consumption and pin-efficiency, especially in high-speed communications. More recently, vector signaling methods have been proposed to further optimize the trade-offs between power consumption, pin efficiency and noise robustness of chip-to-chip communication systems. In those vector signaling systems, digital information at the transmitter is transformed into a different representation space in the form of a vector codeword that is chosen in order to optimize the power consumption, pin-efficiency and speed trade-offs based on the transmission channel properties and communication system design constraints. Herein, this process is referred to as “encoding”. The encoded codeword is communicated as a group of signals from the transmitter to one or more receivers. At a receiver, the received signals corresponding to the codeword are transformed back into the original digital information representation space. Herein, this process is referred to as “decoding”.
Regardless of the encoding method used, the received signals presented to the receiving device must be sampled (or their signal value otherwise recorded) at intervals best representing the original transmitted values, regardless of transmission channel delays, interference, and noise. This Clock and Data Recovery (CDR) not only must determine the appropriate sample timing, but must continue to do so continuously, providing dynamic compensation for varying signal propagation conditions. Many known CDR systems utilize a Phase-Locked Loop (PLL) or Delay-Locked Loop (DLL) to synthesize a local receive clock having an appropriate frequency and phase for accurate receive data sampling.
BRIEF DESCRIPTION
Methods and systems are described for receiving a reference clock signal and a phase of a local oscillator signal at a dynamically-weighted XOR gate comprising a plurality of logic branches, generating a plurality of weighted segments of a phase-error signal, the plurality of weighted segments comprising (i) positive weighted segments generated by a first subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have equal logic levels and (ii) negative weighted segments generated by a second subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have different logic levels, each weighted segment of the phase-error signal having a respective weight applied by a corresponding logic branch of the plurality of logic branches, generating an aggregate control signal based on an aggregation of the weighted segments of the phase-error signal, and outputting the aggregate control signal as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.
To reliably detect the data values transmitted over a communications system, a receiver must accurately measure the received signal value amplitudes at carefully selected times. Various methods are known to facilitate such receive measurements, including reception of one or more dedicated clock signals associated with the transmitted data stream, extraction of clock signals embedded within the transmitted data stream, and synthesis of a local receive clock from known attributes of the communicated data stream.
In general, the receiver embodiments of such timing methods incorporate some form of Clock Data Recovery (CDR), often based on Phase-Lock Loop (PLL) or Delay-Locked Loop (DLL) synthesis of a local receive clock having the desired frequency and phase characteristics. In these embodiments, a Phase Detector compares the relative phase (and in some variations, the relative frequency) of a received reference signal and a local clock signal to produce an error signal, which is subsequently used to correct the phase and/or frequency of the local clock source and thus minimize the error.
[Tajalli I] and [Tajalli II] describe embodiments in which multiple phases or time-offset instances of the received reference clock and/or the local clock are produced and phase compared, allowing additional timing information to be extracted. In such so-called “matrix” phase comparisons, a summation or weighted summation of the multiple phase comparison results is used as the error feedback signal for the PLL. Embodiments described herein combine phase detection functions with adjustable or configurable output weighting, facilitating use in matrix phase comparison.

BRIEF DESCRIPTION OF FIGURES
 FIG. 1 shows multiple XOR gates functioning as phase comparators between reference clock signal Ck_Ref and phases of the local oscillator signal including phases VCO_000, VCO_090, VCO_180, VCO_270, generating an aggregate control signal.
 FIG. 2 is a block diagram of one embodiment of a phase control loop comparing phases VCO_000 and VCO_090 of the local oscillator signal to Ck_Ref.
 FIG. 3 is a schematic diagram of one embodiment of a dynamically-weighted XOR gate, in which each gate branch is configurable to produce a weighted segment of a phase-error signal.
 FIGS. 4A and 4B are schematic diagrams of dynamically-weighted XOR gate embodiments incorporating clocked weighting functions.
 FIG. 5 is a timing diagram illustrating operation of the output weighting function.
 FIGS. 6, 7, 8, 9, and 10 illustrate various aggregate error signals for various reference clock signal-to-local oscillator signal relationships, in accordance with some embodiments.
 FIG. 11 illustrates how the transfer characteristics of a phase comparator may be approximated using adjustable time interval weighting.
 FIGS. 12A and 12B show two embodiments in which a unary selector enables a series of elements to provide a phase-control signal.
 FIG. 13 is a flow chart of a method in accordance with some embodiments.

DETAILED DESCRIPTION
The current state of the art for short-distance wired data communication, such as between integrated circuits on a printed circuit board, exceeds 10 Gbps per wire, for a multiple-wire parallel communications channel. These considerable data rates demand accurate timing control, especially for the timing of the receiver data sampling operation. [Tajalli I] and [Tajalli II] describe generation of such timing clocks using Phase-Locked Loop (PLL) or Delay-Locked Loop (DLL) systems incorporating “matrix” phase comparison operations, in which multiple comparison results between different reference and local clock phases are performed, with the summed result providing a more accurate or informative measure of clock error.
Numerous forms of phase detectors are known to the art. A simple XOR or XNOR gate may be used to compare, as a non-limiting example, two square wave signals. One familiar with the art will observe that such a digital XOR output will be a variable-duty-cycle waveform which, when low pass filtered into an analog error signal, results in a proportional error signal centered in its analog signal range when the two input signals have a 90-degree phase offset relationship. In FIG. 1, multiple dynamically-weighted XOR phase comparisons are made between reference clock signal Ck_Ref and phases of a local oscillator signal including phases VCO_000, VCO_090, VCO_180, VCO_270, resulting in an aggregate control signal. As taught by [Tajalli I] and [Tajalli II], appropriate adjustment of the weights of the various phase error components may be used to adjust the resulting lock phase of the PLL incorporating the matrix phase comparator, introduce additional poles or zeroes into the closed-loop PLL response, etc.
[Tajalli I] and [Tajalli II] additionally disclose that a digital XOR or XNOR gate may be decomposed into a transistor-level gate including sub-elements representing component AND operations subsequently ORed together to implement the desired composite function. Embodiments are described herein in which each such sub-element may be separately weighted so as to produce a more finely adjustable phase-error signal, that may be further combined with phase-error signals from other dynamically-weighted XOR gates receiving different phases of the local oscillator signal to generate the aggregate control signal, thus providing an interpolation. FIG. 3 is one example of this technique, where XOR gate 113 has been decomposed into individual AND terms 310, 320, 330, 340, each including a resistive weighting element, and all of which are ORed together to produce an aggregate control signal Iout that may be used for controlling phase adjustments in a local oscillator. Following standard practice for CMOS logic, NMOS sub-elements 320 and 340 implement the active-low function components Iout=(x·y)+(x·y) and PMOS sub-elements 310 and 330 implement the active-high function components Iout=(x·y)+(x·y). Thus, the resulting phase-error signal output from gate 113 is composed of both positive-weighted (active-high) and negative-weighted (active-low) segments, allowing both active sourcing and sinking of output current.
 FIGS. 4A and 4B illustrate further embodiments, in which configuration of the weighting operations for a decomposed gate such as that of FIG. 3 is performed by enabling input bits t0, t1, t2, t3, rather than by configurable analog resistances. Specifically, they illustrate two versions of 330 in FIG. 3, with quadrants 310, 320, 340 being implemented in similar fashion. Enabling each of input bits t0, t1, t2, t3 turns on an enabling transistor in one of multiple parallel branch segments or paths, each contributing a fixed amount of current to result K. Thus, the number of such branch segments being enabled controls the overall amplitude, that is, weighting, of the overall result Iout. In a practical embodiment, the amount of current in each path may be controlled by appropriate selection of transistor geometry, as is well known in the art. As two examples offered without implying limitation, FIG. 4A shows transistor geometry chosen such that each parallel path contributes an equal amount of current, while FIG. 4B shows transistor geometry chosen such that current contributions double for consecutive parallel paths. Thus, the embodiment of FIG. 4A might be combined with unary (i.e. counting number) selection of input bits t0, t1, t2, t3 using e.g., a thermometer code, while FIG. 4B may be combined with a binary number representation of input bits t0, t1, t2, t3.
 FIG. 5 illustrates the results of utilizing the circuit of FIG. 4A in each quadrant of FIG. 3. Enabling one, two, three, or all of t0, t1, t2, t3 in 330 permits weighting of signal amplitude of weighted segment 510. Similar adjustment in 340 allows configuration as shown by weighted segment 520, adjustment of 310 allows configuration as shown by weighted segment 530, and adjustment in 320 allows configuration as shown by weighted segment 540. In this example using four branch segments paths per branch, a total of sixteen possible signal amplitudes may be obtained for the combined output Iout. In some embodiments, additional constraints may be applied, for example to maintain signal symmetry by always enabling equal numbers of PMOS and NMOS (i.e. positive weighted and negative weighted) branch segments.
As a further example, intentional control of the number of signal paths being enabled provides the ability to adjust lock phase without introduction of a dedicated phase interpolation device. A matrix phase comparator configuration similar to that of FIG. 1 is assumed, although for descriptive simplicity only two-phase comparison elements 113 will be considered. A simplified block diagram of the resulting PLL configuration is shown in FIG. 2, with the two-phase comparator elements 113 in the first instance comparing phase VCO_000 of the local oscillator signal to Ck_Ref, and in the second instance comparing phase VCO_090 of the local oscillator signal to Ck_Ref. The branch segment weights of each phase comparator are adjusted 207, 208 to produce weighted segments that are subsequently combined and low-pass filtered 230 to generate the aggregate control signal that may be used to control the Voltage-Controlled Oscillator (VCO) 240 producing the phases of the local oscillator signal VCO_000 and VCO_090 to induce a phase offset into the phases of the local oscillator signal.
A Phase Interpolation Control Signal Generator 205 accepts a Phase Value input and produces control signals 207, 208, which, by selectively enabling numbers of branch segments in the first dynamically-weighted XOR gate and in the second dynamically-weighted XOR gate, control the relative contribution of each phase comparator instance to the aggregate control signal that may be low-pass filtered 230 and provided to VCO 240.
 FIGS. 6-10 are timing diagrams that illustrate formation of aggregate control signals, in accordance with some embodiments. References to FIG. 3 are made in the following descriptions, however it should be noted that similar examples and concepts may be extended to other similar systems. FIG. 6 illustrates a timing diagram of an interpolation between phases VCO_000 and VCO_090 of the local oscillator signal. As shown, FIG. 6 is the state of the weighted segments of phase-error signals error_000 and error_090 immediately after turning branches 330 and 340 off in a circuit as shown in FIG. 3 that is receiving a reference clock signal and phase VCO_000 of the local oscillator signal, and turning branches 330 and 340 on in a circuit as shown in FIG. 3 that is receiving the reference clock signal and phase VCO_090 of the local oscillator signal. As shown, an aggregation of the shaded portions of weighted segments error_000 and error_090 is mostly negative, and thus the local oscillator is rotated to bring the aggregate control signal to an average of zero, indicating locked condition.
 FIG. 7 illustrates the relationship of phases VCO_000 and VCO_090 of the local oscillator signal with respect to the reference clock signal upon reaching lock condition. As shown, phases VCO_000 and VCO_090 have undergone a −45 degree phase shift with respect to the reference clock signal, and a phase of 45 is now locked to the 90-degree lock point of the phase detector. One would expect such a shift, as half of the XOR detector receiving phase VCO_000 is turned on while half of the XOR detector receiving phase VCO_090 is also turned on, and thus both phases are making equal contributions to the aggregate control signal. As will be further noted, the aggregation of weighted segments of phase-error signals error_000 and error_090 thus as an average result of 0, and the VCO is thus in a lock condition in which phases VCO_000 and VCO_090 have undergone a −45 degree phase shift with respect to the 90-degree lock point described above.
 FIG. 8 illustrates a similar scenario, however in FIG. 8, branches 330 and 340 are turned off for phase VCO_000, while branches 330 and 340 are turned on in phase VCO_270. As expected, phases VCO_000 and VCO_270 undergo a +45 degree phase shift with respect to the previous lock point, and thus a phase of 315 degrees is now locked to the 90-degree lock point of the phase detector.
The above examples describe fully turning branches on/off for simplicity of discussion, however, as shown in FIG. 3, a branch may include a plurality of branch segments that may be individually turned off/on in adjacent phases of the local oscillator signal so that such AND operations may partially contribute to more than one phase-error signal. For example, as shown in FIG. 3, t0 and t1 may be turned off/on in the dynamically-weighted XOR gates receiving phases VCO_000/VCO_090, respectively, which only constitutes as one half of branch 330. Such a scenario is illustrated in FIG. 9. In FIG. 9, only t0 and t1 are turned off in the dynamically-weighted XOR receiving phase VCO_000, and only t0 and t1 are turned on in the dynamically-weighted XOR receiving phase VCO_090. As shown, such a configuration introduces a proportionately smaller offset of approximately −11.25 degrees of phase VCO_000 of the local oscillator signal with respect to the 90-degree lock point to the reference clock signal. The weighted segments of phase-error signals error_000 and error_090 are illustrated in FIG. 9. As shown, the weighted segment associated with branch 330 of phase-error signal error_000 has half the amplitude with respect to the rest of the branches, as only two branch segments are contributing to the weighted segment, while all four branch segments contribute to the rest of the weighted segments of phase-error signal error_000.
In yet another embodiment, simply turning one or more branch segments off in a branch of a dynamically-weighted XOR gate will induce a phase shift, even without turning the corresponding branch segments on in a dynamically-weighted XOR gate receiving an adjacent phase of the local oscillator signal. Such an embodiment is shown in FIG. 10. In FIG. 1, branch segments t0 and t1 are turned off in the dynamically-weighted XOR gate receiving phase VCO_000 of the local oscillator signal, while no branch segments are turned on in the dynamically-weighted XOR gate receiving phase VCO_090. Such an embodiment induces a phase offset into the phases of the local oscillator signal, as the positive and negative portions of the aggregate control signal adjust their widths, e.g., by rotating the phases of the local oscillator signal to change the duty cycle of the output of the XOR gate, to compensate for the sudden negative aggregate control signal until the total positive area and total negative area are equal, thus indicating locked condition. As one may notice, the phase shift induced by the embodiment shown in FIG. 10 will be larger than that of FIG. 9. In FIG. 9, some of the positive portion of the aggregate control signal is added back in via the positively weighted segment of phase-error signal error_090, while in FIG. 10, there is no contribution from error_090. Thus, a larger shift is induced into the phases of the local oscillator signal to compensate.
 FIG. 11 illustrates a desired linear transfer function for the phase interpolation behavior, versus the inherent non-linear result if the two signals were simply mixed by enabling or disabling a fixed number of weighted segments per adjustment step. It may be observed that the non-linear curve produced by using a fixed increment is always “above” the desired linear response, thus linearization requires fewer segments to be enabled per step. In some embodiments, a predetermined sequence of steps may be determined to achieve a more linear phase interpolation relationship, if such a relationship is desired.
 FIG. 12A is one such embodiment for closely approximating a linear interpolation operation, by selectively enabling 32 possible gating signals on a first of two phase-error signal outputs. Each instance of element 1220 represents one weighted segment in a circuit sub-element such as that of FIG. 4A, within a first dynamically-weighted XOR gate such as that of FIG. 3. Unary decoder 1210 enables a selected number of its outputs, as determined by input Step#. In such embodiments, each selected output may control a corresponding branch segment in a branch of the plurality of branches of a dynamically-weighted XOR gate. The linearization function is performed by selectively disconnecting certain instances of 1220 from the overall result Q (that is, not connecting that weighted segment to the corresponding branch segment.) Examples of disconnected branch segments include the instances of 1220 enabled by Unary16, Unary20, Unary22-23, Unary 25-27, and Unary 29-30.
In some embodiments, the number of branch segments enabled to control a first phase-error result and the number of branch segments enabled to control a second phase-error result are coordinated as illustrated by control signal generator 205 of FIG. 2. In at least one embodiment, the number of branch segments in the second phase-error signal are inversely-weighted with respect to branch segments in the first phase-error signal. A complementary embodiment controlling a second dynamically-weighted XOR gate receiving an adjacent phase is shown in FIG. 12B. The outputs I and Q may correspond to phase-control signals 207 and 208, respectively, or vice versa.
 FIG. 13 is a flow chart of a method in accordance with some embodiments. As shown, method 1300 includes receiving 1302 a reference clock signal and a phase of a local oscillator signal at a dynamically-weighted XOR gate comprising a plurality of logic branches. A plurality of weighted segments of a phase error-signal are generated at 1304, the plurality of weighted segments comprising (i) positive weighted segments generated by a first subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have equal logic levels and (ii) negative weighted segments generated by a second subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have different logic levels, each weighted segment of the phase-error signal having a respective weight applied by a corresponding logic branch of the plurality of logic branches. An aggregate control signal is generated 1306 based on an aggregation of the weighted segments of the phase-error signal, and the aggregate control signal is output 1308 as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.
In some embodiments, each logic branch comprises a plurality of branch segments connected in parallel. In such embodiments, the method further includes generating a phase-control signal comprising a plurality of bits. In some embodiments, each branch segment is enabled according to a respective bit of the plurality of bits of the phase-control signal. In some embodiments, each branch segment is enabled according to a corresponding enabling transistor receiving the respective bit as an input. In some embodiments, the respective weight for a given weighted segment is determined by a number of branch segments enabled in the logic branch.
In some embodiments, the respective weight for a given weighted segment is determined in part by transistor dimensions in the logic branch. In alternative embodiments, the respective weight for a given weighted segment is determined in part by a tunable impedance connected to the logic branch.
In some embodiments, the aggregate control signal is further generated based on weighted segments in a second phase-error signal generated using the reference clock signal and a second phase of the local oscillator signal that is adjacent to the phase of the local oscillator signal. In some such embodiments, weighted segments in the second phase-error signal are inversely-weighted with respect to weighted segments in the first phase-error signal. In some embodiments, the induced phase offset corresponds to a non-zero average of the aggregate control signal.
In some embodiments, a method includes receiving a reference clock signal, and first and second phases of a local oscillator signal. Corresponding sets of weighted segments of a first and a second phase-error signal are generated by comparing the reference clock signal to the first and the second phases of the local oscillator signal, respectively, each corresponding set of weighted segments generated by a plurality of logic branches of a respective dynamically-weighted XOR gate, wherein the weighted segments in each of the first and second phase-error signals comprise first and second sets of weights, respectively, the first and second sets of weights selected according to a predetermined phase-offset value. An aggregate control signal is generated based on a summation of the weighted segments of the first and second phase-error signals, and the aggregate control signal is output as a current-mode output for controlling a local oscillator generating the first and second adjacent phases of the local oscillator signal, the local oscillator configured to induce a phase offset into the first and second phases of the local oscillator signal in response to the aggregate control signal by an amount associated with the predetermined phase-offset value.
In some embodiments, the weighted segments in each of the first and second segmented phase-error signals include (i) positive weighted segments generated by a first subset of the plurality of logic branches when the reference clock signal and the corresponding phase of the local oscillator signal have equal logic levels and (ii) negative weighted segments generated by a second subset of the plurality of logic branches when the reference clock signal and the corresponding phase of the local oscillator signal have different logic levels.
In some embodiments, the first and second sets of weights correspond to a total number of logic branch segments enabled in the respective dynamically-weighted XOR gates.
In some embodiments, the first and second sets of weights are selected according to a phase-control signal representing the predetermined phase-offset value of the first and second phases of the local oscillator signal. In some such embodiments, the phase-control signal is generated by a phase-control signal generator. In some embodiments, the phase-control signal generator includes a lookup table and is configured to select a phase-control signal from the lookup table. In some such embodiments, the lookup table may include phase-control signal steps that implement a linear interpolation function. In some embodiments, the phase-control signal may be a thermometer code. In such embodiments, the dynamically-weighted XOR receiving the first phase of the local oscillator signal may receive a thermometer code that is an inverse of a thermometer code received by the dynamically-weighted XOR receiving the second phase of the local oscillator signal.
In some embodiments, the first and second phases of the local oscillator signal have phase differences of 45 degrees. In some embodiments, the first and second phases of the local oscillator signal may have phase differences of 90 degrees or 180 degrees. In some embodiments, the first and second phases of the local oscillator signal may be adjacent phases in that they are pulled from adjacent ring oscillator elements in a local oscillator.

The invention claimed is:
 
1. A method comprising:
receiving a reference clock signal and a phase of a local oscillator signal at a dynamically-weighted XOR gate comprising a plurality of logic branches, each logic branch enabled responsive to a respective input logic combination of the reference clock signal and the phase of the local oscillator signal;
generating a plurality of weighted segments of a phase-error signal, the plurality of weighted segments comprising (i) positive weighted segments generated by a first subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have equal logic levels and (ii) negative weighted segments generated by a second subset of the plurality of logic branches when the reference clock signal and the phase of the local oscillator signal have different logic levels, each weighted segment of the phase-error signal having a respective weight applied by a corresponding logic branch of the plurality of logic branches, wherein at least two weighted segments of the plurality of weighted segments have different weights;
generating an aggregate control signal based on an aggregation of the weighted segments of the phase-error signal; and
outputting the aggregate control signal as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.


  
2. The method of claim 1, wherein each logic branch comprises a plurality of branch segments connected in parallel.

  
3. The method of claim 2, further comprising generating a phase-control signal comprising a plurality of bits, and wherein each branch segment is enabled according to a respective bit of the plurality of bits of the phase-control signal.

  
4. The method of claim 3, wherein each branch segment is enabled according to a corresponding enabling transistor receiving the respective bit as an input.

  
5. The method of claim 3, wherein generating the phase-control signal comprises selecting a value corresponding to the phase offset from a lookup table.

  
6. The method of claim 2, wherein the respective weight for a given weighted segment is determined by a number of branch segments enabled in the logic branch.

  
7. The method of claim 1, wherein the respective weight for a given weighted segment is determined in part by transistor dimensions in the logic branch.

  
8. The method of claim 1, wherein the respective weight for a given weighted segment is determined in part by a tunable impedance connected to the logic branch.

  
9. The method of claim 1, wherein the aggregate control signal is further generated based on weighted segments in a second phase-error signal generated using the reference clock signal and a second phase of the local oscillator signal that is adjacent to the phase of the local oscillator signal.

  
10. The method of claim 9, wherein the first and second phase-error signals are generated using sets of inversely-enabled branch segments.

  
11. An apparatus comprising:
a plurality of logic branches of a dynamically-weighted XOR gate, the plurality of logic branches configured to receive a reference clock signal and a phase of a local oscillator signal and to responsively generate a plurality of weighted segments of a phase-error signal, each weighted segment of the phase-error signal generated by a corresponding logic branch enabled responsive to a respective input logic combination of the reference clock and the phase of the local oscillator and having a respective weight selectively applied by a corresponding logic branch of the plurality of logic branches, wherein at least two weighted segments of the plurality of weighted segments have different weights, the plurality of logic branches comprising:
a first subset of the plurality of logic branches configured to generate positive weighted segments when the reference clock signal and the phase of the local oscillator signal have equal logic levels;
a second subset of the plurality of logic branches configured to generate negative weighted segments when the reference clock signal and the phase of the local oscillator signal have different logic levels; and

a common node connected to the plurality of logic branches configured to generate an aggregate control signal based on an aggregation of the weighted segments of the phase-error signal, and to responsively output the aggregate control signal as a current-mode output for controlling a local oscillator generating the phase of the local oscillator signal, the local oscillator configured to induce a phase offset into the local oscillator signal in response to the aggregate control signal.


  
12. The apparatus of claim 11, wherein each logic branch comprises a plurality of branch segments connected in parallel.

  
13. The apparatus of claim 12, further comprising a phase interpolator control signal generator configured to generate a phase-control signal comprising a plurality of bits, and wherein each branch segment is enabled according to a respective bit of the plurality of bits of the phase-control signal.

  
14. The apparatus of claim 13, wherein each branch segment comprises a corresponding enabling transistor configured to receive the respective bit as an input.

  
15. The apparatus of claim 13, wherein the phase interpolator control signal generator is configured to generate the phase-control signal by selecting a value corresponding to the phase offset from a lookup table.

  
16. The apparatus of claim 12, wherein the respective weight for a given weighted segment is determined by a number of branch segments enabled in the logic branch.

  
17. The apparatus of claim 11, wherein the respective weight for a given weighted segment is determined in part by transistor dimensions in the logic branch.

  
18. The apparatus of claim 11, wherein the respective weight for a given weighted segment is determined in part by a tunable impedance connected to the logic branch.

  
19. The apparatus of claim 11, wherein the aggregate control signal is further generated based on weighted segments in a second phase-error signal generated using the reference clock signal and a second phase of the local oscillator signal that is adjacent to the phase of the local oscillator signal.

  
20. The apparatus of claim 19, wherein the first and second phase-error signals are generated using sets of inversely-enabled branch segments.
Source: [US10333749B2](https://patents.google.com/patent/US10333749B2)

# [US10333749B2](US10333749B2.md) - [US10333749B2](US10333749B2.md) - Vector signaling code with improved noise margin

## Details

* Date: 2014-05-13
* Inventor: Kandou Labs SA
* Beneficiary: Amin Shokrollahi

## Other patents

### Backwards
 * US668687A
 * US780883A
 * US3196351A
 * US3636463A
 * US3939468A
 * US4163258A
 * US4181967A
 * US4206316A
 * US4276543A
 * US4486739A
 * [US4499550A](US4499550A.md)
 * US4722084A
 * US4772845A
 * US4774498A
 * US4864303A
 * US4897657A
 * [US4974211A](US4974211A.md)
 * US5017924A
 * US5053974A
 * US5150384A
 * [US5166956A](US5166956A.md)
 * US5168509A
 * US5266907A
 * US5283761A
 * US5287305A
 * US5311516A
 * US5331320A
 * [US5412689A](US5412689A.md)
 * US5449895A
 * US5459465A
 * US5461379A
 * US5510736A
 * US5511119A
 * US5553097A
 * US5566193A
 * US5599550A
 * US5626651A
 * US5629651A
 * US5659353A
 * US5727006A
 * US5748948A
 * US5802356A
 * [US5825808A](US5825808A.md)
 * US5856935A
 * US5875202A
 * US5945935A
 * US5949060A
 * US5982954A
 * US5995016A
 * US5999016A
 * [US6005895A](US6005895A.md)
 * [US6084883A](US6084883A.md)
 * US6119263A
 * US6154498A
 * US6172634B1
 * US6175230B1
 * US6232908B1
 * [US6278740B1](US6278740B1.md)
 * US6316987B1
 * US6317465B1
 * US6346907B1
 * US20020044316A1
 * US6378073B1
 * US6384758B1
 * US20020057592A1
 * US6398359B1
 * US6404820B1
 * US6417737B1
 * US6424630B1
 * US20020097791A1
 * US6433800B1
 * [US6452420B1](US6452420B1.md)
 * US20020152340A1
 * US20020154633A1
 * US6473877B1
 * US20020167339A1
 * US6483828B1
 * US20020174373A1
 * US20020181607A1
 * US6509773B2
 * US20030016763A1
 * US20030016770A1
 * US6522699B1
 * US20030046618A1
 * [US6556628B1](US6556628B1.md)
 * US20030085763A1
 * US6563382B1
 * JP2003163612A
 * US20030117184A1
 * US20030146783A1
 * US6621427B2
 * US20030174023A1
 * US6624699B2
 * US20030185310A1
 * US6650638B1
 * US20030218558A1
 * [US6661355B2](US6661355B2.md)
 * US6664355B2
 * US6686879B2
 * US6690739B1
 * US20040027185A1
 * US20040057525A1
 * [US6766342B2](US6766342B2.md)
 * US20040146117A1
 * US6772351B1
 * US20040155802A1
 * US20040161019A1
 * US20040169529A1
 * US20040239374A1
 * [US6839429B1](US6839429B1.md)
 * US6839587B2
 * WO2005002162A1
 * US6854030B2
 * US6865236B1
 * US6865234B1
 * US6876317B2
 * US20050134380A1
 * US6927709B2
 * US20050174841A1
 * US20050195000A1
 * US20050201491A1
 * US20050213686A1
 * US20050220182A1
 * [US6954492B1](US6954492B1.md)
 * US6963622B2
 * US6972701B2
 * US6973613B2
 * US20050270098A1
 * US6976194B2
 * US6982954B2
 * US20060013331A1
 * [US6990138B2](US6990138B2.md)
 * US6991038B2
 * US6993311B2
 * [US6999516B1](US6999516B1.md)
 * US20060036668A1
 * US7023817B2
 * US7038486B2
 * US7039136B2
 * US20060097786A1
 * US20060103463A1
 * US7053802B2
 * US20060126751A1
 * US20060140324A1
 * US7075996B2
 * US7080288B2
 * US20060159005A1
 * US7082557B2
 * US7085336B2
 * US7085153B2
 * US20060233291A1
 * CN1864346A
 * US7142865B2
 * [US7142612B2](US7142612B2.md)
 * US20070001723A1
 * US20070002954A1
 * US7164631B2
 * US7167019B2
 * US20070030796A1
 * US7176823B2
 * [US7180949B2](US7180949B2.md)
 * US7199728B2
 * US20070103338A1
 * US7231558B2
 * US20070164883A1
 * US20070182487A1
 * US20070204205A1
 * US20070201546A1
 * US7269212B1
 * US7269130B2
 * US20070263711A1
 * US20070283210A1
 * US20080007367A1
 * US20080012598A1
 * US20080016432A1
 * US7335976B2
 * US7336112B1
 * US7339990B2
 * US7346819B2
 * US7349484B2
 * US7348989B2
 * US7356213B1
 * US7358869B1
 * US7362697B2
 * US7366942B2
 * US20080104374A1
 * US7370264B2
 * US7372390B2
 * EP1926267A1
 * [US7389333B2](US7389333B2.md)
 * US20080159448A1
 * US7397302B2
 * US7400276B1
 * US20080192621A1
 * US7428273B2
 * US7462956B2
 * US20080317188A1
 * US20090046009A1
 * US7496162B2
 * US20090059782A1
 * US20090115523A1
 * US7535957B2
 * US7539532B2
 * US20090150754A1
 * CN101478286A
 * WO2009084121A1
 * US7570704B2
 * US20090195281A1
 * US7583209B1
 * US7599390B2
 * US20090262876A1
 * US7613234B2
 * US7616075B2
 * US7620116B2
 * [US7633850B2](US7633850B2.md)
 * US20090316730A1
 * US7639596B2
 * US20090323864A1
 * US7643588B2
 * US7650525B1
 * US7656321B2
 * US20100046644A1
 * WO2010031824A1
 * US20100081451A1
 * US7694204B2
 * US7697915B2
 * US7698088B2
 * US7706524B2
 * US7706456B2
 * US20100148819A1
 * US20100180143A1
 * US7768312B2
 * US20100215118A1
 * US20100215112A1
 * US7787572B2
 * CN101820288A
 * US20100235673A1
 * US7804361B2
 * US7808456B2
 * CN101854223A
 * US20100271107A1
 * US7826551B2
 * US20100283894A1
 * US20100296556A1
 * US7841909B2
 * US20100309964A1
 * US7859356B2
 * US7869497B2
 * US7869546B2
 * US7868790B2
 * US7882413B2
 * US20110028089A1
 * US20110032977A1
 * US7899653B2
 * US20110051854A1
 * US20110072330A1
 * US20110074488A1
 * US20110084737A1
 * US7933770B2
 * US20110103508A1
 * US8000664B2
 * US20110228864A1
 * WO2011119359A2
 * US8030999B2
 * US8036300B2
 * US8050332B2
 * US20110268225A1
 * US8055095B2
 * US8064535B2
 * US20110286497A1
 * US20110302478A1
 * [US20110299555A1](US20110299555A1.md)
 * US8085172B2
 * US20110317559A1
 * US8106806B2
 * US20120036415A1
 * US8149906B2
 * US20120082203A1
 * [US8159376B2](US8159376B2.md)
 * US8180931B2
 * US8185807B2
 * US20120133438A1
 * US8199849B2
 * US8199863B2
 * US20120152901A1
 * US20120161945A1
 * US8218670B2
 * US8233544B2
 * US8245102B1
 * US8245094B2
 * US20120213299A1
 * US8253454B2
 * US8279094B2
 * US8279976B2
 * US8284848B2
 * US8289914B2
 * US8295336B2
 * US8295250B2
 * US8310389B1
 * US8341492B2
 * US20130010892A1
 * US20130013870A1
 * US8359445B2
 * US8365035B2
 * EP2039221B1
 * US8406316B2
 * US8406315B2
 * US8429492B2
 * US8429495B2
 * US20130106513A1
 * US8437440B1
 * US20130114392A1
 * US20130114663A1
 * US20130114519A1
 * US8443223B2
 * US8442099B1
 * US20130129019A1
 * US20130147553A1
 * US20130159584A1
 * US8472513B2
 * US20130188656A1
 * US8498368B1
 * US20130195155A1
 * US20130202065A1
 * US20130215954A1
 * US8520348B2
 * US8547272B2
 * US20130259113A1
 * US20130271194A1
 * US8577284B2
 * US8578246B2
 * US8588254B2
 * US20130307614A1
 * US8593305B1
 * US20130314142A1
 * US20130315501A1
 * US8602643B2
 * US8604879B2
 * US20130346830A1
 * US8620166B2
 * US8638241B2
 * US8643437B2
 * US8649556B2
 * US8649840B2
 * US20140068391A1
 * US8674861B2
 * US8687968B2
 * US8718184B1
 * US20140159769A1
 * US8755426B1
 * US20140177696A1
 * US8773964B2
 * US8780687B2
 * US8782578B2
 * US8831440B2
 * US20140254642A1
 * US20140269130A1
 * US20140266440A1
 * US8841936B2
 * US8879660B1
 * US8898504B2
 * US8938171B2
 * US8951072B2
 * US20150049798A1
 * US8975948B2
 * US20150070201A1
 * US20150078479A1
 * US8989317B1
 * US8996740B2
 * US9020049B2
 * US9036764B1
 * US20150146771A1
 * US9059816B1
 * US9069995B1
 * US9077386B1
 * US9083576B1
 * US9093791B2
 * US9100232B1
 * US20150236885A1
 * US9124557B2
 * US20150249559A1
 * US9148087B1
 * US9152495B2
 * US9172412B2
 * US9178503B2
 * US9183085B1
 * US20150333940A1
 * US9197470B2
 * US20150349835A1
 * US20150381232A1
 * US20150380087A1
 * US9231790B2
 * US20160020796A1
 * US20160020824A1
 * US20160036616A1
 * US9281785B2
 * [US9288082B1](US9288082B1.md)
 * US9292716B2
 * US9300503B1
 * US9306621B2
 * US9331962B2
 * US9374250B1
 * US9432298B1
 * US20160261435A1
 * US9455765B2
 * US9455744B2
 * US9479369B1
 * US9537644B2
 * US9634797B2
 * US9710412B2
 * US20170310456A1
 * US20170317449A1
 * US20170317855A1
### Forward
 * 
## Abstract

Abstract

Methods are described allowing a vector signaling code to encode multi-level data without the significant alphabet size increase known to cause symbol dynamic range compression and thus increased noise susceptibility. By intentionally restricting the number of codewords used, good pin efficiency may be maintained along with improved system signal-to-noise ratio.



Methods are described allowing a vector signaling code to encode multi-level data without the significant alphabet size increase known to cause symbol dynamic range compression and thus increased noise susceptibility. By intentionally restricting the number of codewords used, good pin efficiency may be maintained along with improved system signal-to-noise ratio.

This application is a continuation of U.S. application Ser. No. 14/711,528, filed May 13, 2015, entitled “VECTOR SIGNALING CODE WITH IMPROVED NOISE MARGIN”, which claims the benefit of U.S. Provisional Patent Application 61/992,711, filed May 13, 2014, entitled “Vector Signaling Code with Improved Noise Margin” all of which are herein incorporated by reference in their entireties for all purposes.
REFERENCES
The following references are herein incorporated by reference in their entirety for all purposes:
U.S. Patent Publication No. 2011/0268225 of U.S. patent application Ser. No. 12/784,414, filed May 20, 2010, naming Harm Cronie and Amin Shokrollahi, entitled “Orthogonal Differential Vector Signaling” (hereinafter “Cronie I”);
U.S. Patent Publication No. 2011/0302478 of U.S. patent application Ser. No. 13/154,009, filed Jun. 6, 2011, naming Harm Cronie and Amin Shokrollahi, entitled “Error Control Coding for Orthogonal Differential Vector Signaling” (hereinafter “Cronie II”);
U.S. patent application Ser. No. 13/030,027, filed Feb. 17, 2011, naming Harm Cronie, Amin Shokrollahi and Armin Tajalli, entitled “Methods and Systems for Noise Resilient, Pin-Efficient and Low Power Communications with Sparse Signaling Codes” (hereinafter “Cronie III”);
U.S. Patent Publication No. 2011/0299555 of U.S. patent application Ser. No. 13/154,009, filed Jun. 6, 2011, naming Harm Cronie and Amin Shokrollahi, entitled “Error Control Coding for Orthogonal Differential Vector Signaling” (hereinafter “Cronie IV”);
U.S. Provisional Patent Application No. 61/763,403, filed Feb. 11, 2013, naming John Fox, Brian Holden, Ali Hormati, Peter Hunt, John D Keay, Amin Shokrollahi, Anant Singh, Andrew Kevin John Stewart, Giuseppe Surace, and Roger Ulrich, entitled “Methods and Systems for High Bandwidth Chip-to-Chip Communications Interface” (hereinafter called “Fox I”);
U.S. Provisional Patent Application No. 61/773,709, filed Mar. 6, 2013, naming John Fox, Brian Holden, Peter Hunt, John D Keay, Amin Shokrollahi, Andrew Kevin John Stewart, Giuseppe Surace, and Roger Ulrich, entitled “Methods and Systems for High Bandwidth Chip-to-Chip Communications Interface” (hereinafter called “Fox II”);
U.S. Provisional Patent Application No. 61/812,667, filed Apr. 16, 2013, naming John Fox, Brian Holden, Ali Hormati, Peter Hunt, John D Keay, Amin Shokrollahi, Anant Singh, Andrew Kevin John Stewart, and Giuseppe Surace, entitled “Methods and Systems for High Bandwidth Communications Interface” (hereinafter called “Fox III”);
U.S. patent application Ser. No. 13/842,740, filed Mar. 15, 2013, naming Brian Holden, Amin Shokrollahi, and Anant Singh, entitled “Methods and Systems for Skew Tolerance and Advanced Detectors for Vector Signaling Codes for Chip-to-Chip Communication” (hereinafter called “Holden I”);
U.S. patent application Ser. No. 13/895,206, filed May 15, 2013, naming Roger Ulrich and Peter Hunt, entitled “Circuits for Efficient Detection of Vector Signaling Codes for Chip-to-Chip Communications using Sums of Differences” (hereinafter called “Ulrich I”).
U.S. Provisional Patent Application No. 61/934,804, filed Feb. 2, 2014, naming Ali Hormati and Amin Shokrollahi, entitled “Method for Code Evaluation using ISI Ratio” (hereinafter called “Hormati I”).
U.S. Provisional Patent Application No. 61/839,360, filed Jun. 23, 2013, naming Amin Shokrollahi, entitled “Vector Signaling Codes with Reduced Receiver Complexity” (hereinafter called “Shokrollahi I”).
U.S. Patent Application No. 61/934,800, filed Feb. 2, 2014, naming Amin Shokrollahi and Nicolae Chiurtu, entitled “Low EMI Signaling for Parallel Conductor Interfaces” (hereinafter called “Shokrollahi II”).
TECHNICAL FIELD
The present invention relates to communications in general and in particular to the transmission of signals capable of conveying information and detection of those signals in chip-to-chip communication.
BACKGROUND
In communication systems, a goal is to transport information from one physical location to another. It is typically desirable that the transport of this information is reliable, is fast and consumes a minimal amount of resources. One common information transfer medium is the serial communications link, which may be based on a single wire circuit relative to ground or other common reference, or multiple such circuits relative to ground or other common reference. A common example uses singled-ended signaling (“SES”). SES operates by sending a signal on one wire, and measuring the signal relative to a fixed reference at the receiver. A serial communication link may also be based on multiple circuits used in relation to each other. A common example of the latter uses differential signaling (“DS”). Differential signaling operates by sending a signal on one wire and the opposite of that signal on a matching wire. The signal information is represented by the difference between the wires, rather than their absolute values relative to ground or other fixed reference.
There are a number of signaling methods that maintain the desirable properties of DS while increasing pin efficiency over DS. Vector signaling is a method of signaling. With vector signaling, a plurality of signals on a plurality of wires is considered collectively although each of the plurality of signals might be independent. Each of the collective signals is referred to as a component and the number of plurality of wires is referred to as the “dimension” of the vector. In some embodiments, the signal on one wire is entirely dependent on the signal on another wire, as is the case with DS pairs, so in some cases the dimension of the vector might refer to the number of degrees of freedom of signals on the plurality of wires instead of exactly the number of wires in the plurality of wires.
With binary vector signaling, each component or “symbol” of the vector takes on one of two possible values. With non-binary vector signaling, each symbol has a value that is a selection from a set of more than two possible values. The set of values that a symbol of the vector may take on is called the “alphabet” of the vector signaling code. A vector signaling code, as described herein, is a collection C of vectors of the same length N, called codewords. Any suitable subset of a vector signaling code denotes a “sub code” of that code. Such a subcode may itself be a vector signaling code.
In operation, the coordinates of the codewords are bounded, and we choose to represent them by real numbers between −1 and 1. The ratio between the binary logarithm of the size of C and the length N is called the pin-efficiency of the vector signaling code.
A vector signaling code is called “balanced” if for all its codewords the sum of the coordinates is always zero. Balanced vector signaling codes have several important properties. For example, as is well known to those of skill in the art, balanced codewords lead to lower electromagnetic interference (EMI) noise than non-balanced ones. Also, if common mode resistant communication is required, it is advisable to use balanced codewords, since otherwise power is spent on generating a common mode component that is cancelled at the receiver.
An example of a typical systems environment incorporating vector signaling code communication as described in the prior art is shown in FIG. 1. As will be subsequently described, one goal of the present invention is to provide improved performance, particularly regarding signal to noise ratio, while maintaining as much as possible this systems environment.
Information to be transmitted 100 is obtained from a source SRC and presented to transmitter 120. Within the transmitter, the information is encoded 122 as symbols of a vector signaling code 125, which are then presented to transmit driver 128, generating physical representations of the code symbols on a collection of wires 145 which together comprise the communications channel 140.
Receiver 160 accepts physical signals from communications channel 140, detects the received codewords using, as one example, a collection of differential binary multi-input comparators (as taught by Holden I) 166, and then decodes 168 those detected values 167 to obtain the received information 180 output to a destination device DST. For some preferred encoder mappings, detected binary values 167 may map directly to bits of received information 180, making an explicit decoding operation unnecessary.
In a practical embodiment, signals 145 may undergo significant change in amplitude, waveform, and other characteristics between emission by transmitter 120 and arrival at receiver 160, due to the transmission characteristics of communications channel 140. Therefore, it is common practice to incorporate signal amplification and/or equalization 162 into communications channel receivers.
Additional examples of vector signaling methods are described in Cronie I, Cronie II, Cronie III, Cronie IV, Fox I, Fox II, Fox III, Holden I, Shokrollahi I, Shokrollahi II, and Hormati I.
BRIEF DESCRIPTION
Combining multi-level signaling with a vector signaling code results in significant increase in the number of available codewords. Properties and the construction method of such combinations are disclosed where the number of active codewords in the combined code is intentionally restricted to provide increased detection threshold for receive detectors, thus improving the signal-to-noise ratio of the resulting system.

BRIEF DESCRIPTION OF FIGURES
 FIG. 1 is an example of a typical prior art systems environment incorporating vector signaling code communication.
 FIG. 2 is a block diagram of a system of vector signaling code communication.
 FIG. 3 is a block diagram of illustrating vector code signaling communication using a pre-coding operation to constrain the code space alphabet.
 FIG. 4 is a schematic of a circuit for a generalized comparator providing PAM-X slicing.
 FIG. 5 is a graph showing SNR increase versus number of transmitted bits per codeword for one embodiment of the invention.
 FIG. 6 is a graph showing SNR increase versus number of transmitted bits per codeword for another embodiment of the invention.
 FIG. 7 is a block diagram showing a method of obtaining improved SNR using vector signaling codes with a constrained alphabet.
 FIG. 8 is a block diagram showing an alternative method of obtaining improved SNR using vector signaling codes with a constrained alphabet, wherein the constraint computations are performed offline.
 FIG. 9 is a flowchart showing a method in accordance with at least one embodiment of the invention.

DETAILED DESCRIPTION
When using the Hadamard Transform, or some other orthogonal transform, to construct vector signaling codes the code alphabet size may grow to be considerably larger than that of the input data alphabet. As one example, the ENRZ code described in FOX II and called H4 code by Cronie I encodes three binary data bits into a four element codeword with a four value alphabet. Typically, the larger the code alphabet size, the smaller the swing at the comparator outputs used to detect the code, and therefore the smaller the SNR of the system in terms of vertical eye opening. In the case of ENRZ, the code is constrained to only require two of the four possible alphabet values in any given codeword, thus avoiding this problem. For codes not naturally providing such constraints, it may be desirable to decrease the code alphabet size at the expense of (slightly) lowering the pin-efficiency. Methods are described to achieve this kind of tradeoff.
Multi-Level Data and Orthogonal Vector Signaling Code
Expanding on the description taught in Cronie I and other prior art, the construction of orthogonal vector signaling codes encoding multi-level Input Data proceeds as illustrated in FIG. 2. Given an interface size N−1 for communications channel 235, an orthogonal matrix A as at 220 is chosen that has N rows and N columns and such that the sum of the columns of A is a column consisting entirely of zeros except in one position (for example, the first position.) Given matrix A and multi-level Input Data described herein as vector c, the codewords are constructed via the multiplication

(0,c 1 ,c 2 , . . . ,c N-1)*A  (Eqn. 1)

wherein the ci may belong to a constellation of PAM-M values, and wherein PAM-M denotes the set {M−1, M−3, . . . , 3−M, 1−M}/(M−1). By convention, the matrix multiplication of Equation 1 is generally combined with a normalization operation, in which all results are divided by a scaling factor to keep the range of results within the bounds +1 to −1. The N coordinates of the scaled results 225 are transmitted on the N communication wires 235 using drivers 230.

At the receiver, the received values (v1, . . . , vN) on the wires are processed by a receiver front end 240 that performs tasks such as continuous time linear equalization and amplification to compensate for transmission line losses, and the processed received signals 245 are forwarded to a linear combinatorial network 250. The result of this network 255 is functionally equivalent to performing the matrix multiplication
       B *  (     v 1      ⋮      v n     )      (  Eqn .     ⁢ 2  )       
where B is the matrix consisting of rows 2, . . . , N of A in the case where the sum of the columns of A is nonzero in the first position. More generally, if the sum of the columns of the matrix A is nonzero in position k, say, then B consists of all rows of A except row k. Again, by convention this matrix multiplication of Equation 2 is generally combined with a normalization operation in which all results are divided by a scaling factor to keep the range of results within the bounds +1 to −1.

If A is a Hadamard matrix, one example of a suitable linear combinatorial network is that of the well-known Fast Walsh Transform; another example is the multi-input differential comparator of Holden I operated in a linear output mode.
The individual components of this new vector are then passed through a PAM-M detector 260 wherein the thresholds of the detector are set appropriately to detect the M levels produced by the matrix multiplication of Eqn. 2 at 255. These detected results 265 are then decoded 270 to produce Output Data.
Alphabet Size
The individual coordinates after the multiplication of Equation 1 may belong to an alphabet of size larger than M, which is the size of the original alphabet of the ci. For example, where A is a Hadamard matrix, the size of the alphabet (that is, the total number of different signal levels transmitted on the wires) may grow to (N−1)*(M−1)+1, which can be quite a large number. More significantly, the range of values represented by this enlarged alphabet also grows, thus the normalization operation required to scale the matrix multiplication results to the range +1 to −1 (e.g. so that they may be transmitted over a physical communications medium using fixed and thus limited driver voltage sources) requires division by larger scaling factors, resulting in the steps between alphabet values shrinking. Thus, when transmitted over a noisy communications channel, these increasing scale factors can lead to a reduced signal-to-noise ratio (SNR) on the wire.
This expansion of the matrix multiplication result range is similar to the increased crest factor observed in CDMA communications systems as the number of modulation channels is increased. Either additional transmission power must be provided to support higher peak signal strength, or the overall transmission envelope is maintained within a constrained range and the individual channel SNR decreases.
To avoid these reduced SNR effects, it is desirable to constrain the alphabet required to communicate the results of the Equation 1 multiplication. Cronie II describes pruning of the symbol constellation produced by an encoding matrix multiplications as in Equation 1 to maximize the Euclidian distance between the signals generated by the encoding operation relative to the noise power of the communications channel. Although that constraint method improves SNR, it also significantly reduces the amount of data transmitted per pin or pin efficiency, and does not directly address the increased normalization scaling factor required.
Enhancing Detection SNR
In the method to be applied here we choose the vector (c1, c2, . . . , cN-1) from a constrained set of vectors, also called a “pre-code” in the following, in such a way as to decrease the alphabet size produced by the multiplication of Equation 1 by eliminating extreme values, thus eliminating the need for larger normalization factors for the results. In at least one embodiment, the constrained set of vectors is determined as a portion of a maximal set of vectors, and the transformation applied representing multiplication of the constrained set of vectors with a non-simple orthogonal matrix forms constrained-alphabet codewords of a constrained-alphabet vector signaling code. These constrained-alphabet codewords include elements having values selected from a constrained post-transformation alphabet formed by the transformation of the constrained set of vectors. This constrained post-transformation alphabet is a reduced version excluding extreme values (i.e. values having large respective magnitudes) of a non-constrained post-transform alphabet that would be formed by applying the transformation to the maximal set of vectors. As mentioned above, this constrained post-transformation alphabet requires smaller normalization factors, which in turn increases the SNR of a system in accordance with at least one embodiment of the invention.
This can be done in a variety of ways, as described below using the illustration of FIG. 3. Pre-encoder 310 maps a given number of Input Data bits (or higher-order symbols) into a codeword 315 of the pre-code prior to encoding matrix multiplication 320, and a decoder 370 maps the detected results 365 to Output Data bits (or higher order symbols.) Decoder 370 may incorporate both a pre-code decoding function and the result mapping decode operation of decoder 270 of FIG. 2; in some embodiments, one or both of these decoding operations may be null or a direct mapping. Encoding matrix 220, decoding linear combinatorial network 250, PAM-X slicer 260, driver 230, and receiver front end 240 are functionally identical in their FIG. 2 and FIG. 3 depictions, while signals 325, 335, and 345 are numbered as distinct from their respective FIG. 2 equivalents 225, 235, and 245 solely due to the range constraint of their values produced by the invention in their FIG. 3 versions.
Forcing to Zero
In a first example embodiment, a given number of the ci are forced to be zero, constraining the scope of the resulting matrix multiplication results. Where k of the ci are forced to be equal to zero, the constrained post-transformation alphabet size after the multiplication in Equation 1 will grow to at most a size of (N−k−1)*(M−1)+1 for a Hadamard matrix. This can be substantially smaller in certain cases. Moreover, unlike in the method of Cronie II, the reduction of the code-space may not be too much. Since the forced value of 0 will be part of the detected results (as in 355 of FIG. 3) and needs to be detected, this method is applied when the ci belong to a PAM-M constellation with M being an odd number.
As a specific example, consider an embodiment with N=4, M=3, and the Hadamard matrix of size 4. In this case the unconstrained pre-code has 27 elements, and the unconstrained post-transform alphabet size is 7. However, choosing a constrained set of vectors (c1, c2, c3) which contain at least one zero, i.e., k=1, a constrained post-transform alphabet having a size of 5 is formed. The number of such constrained-alphabet codewords is 19; the 12 permutations of (1,0,0,−1), the 6 permutations of (½,½,−½,−½), and the vector (0,0,0,0). In at least one embodiment, the codeword (0,0,0,0) is not chosen for transmission, in order to have the same amount of power used for every transmitted codeword. Among the remaining 18 constrained-alphabet codewords any 16 can be chosen for transmission, encoding four binary bits of data. The remaining two constrained-alphabet codewords are available for control functions, pattern breaking, or other auxiliary communication use.
An encoder embodiment for the precode operation is now described with reference to the specific precode consisting of all the 12 permutations of the vector (1,0,0,−1), and the four additional vectors (½, ½, −½, −½) (−½, ½, ½, −½), (−½,−½,½,½), and (½,−½,−½,½). The task of this encoder is to produce four bit vectors u, v, w, s from a four bit input (a,b,c,d). In operation, the encoded vector is equal to u−v+(w−s)/2. In other words, u encodes the positions of the 1's, v encodes the position of the −1's, w encodes the positions of the ½'s, and s encodes the positions of the −½'s. Explicit logical formulas are given below. In these formulas, “*” is the logical AND, c is the logical inverse of c, “xor” denotes the xor operation, and “nor” denotes the logical NOR operation.
    If (a*b)=0, then:

u=(c*d,  c*d,c*  d,nor(c,d))

v=(xor(c,  a)*xor(d,  b),xor(c,a)*xor(d,  b),xor(c,  a)*xor(d,b),xor(c,a)*xor(d,b)

w=(0,0,0,0),s−(0,0,0,0)

If(a*b)=1,then:

u=(0,0,0,0)

v=(0,0,0,0)

w=(xor(c,d), c,xor(c,d),c)

s=(xor(c,d),c,(xor(c,d), c)

    As a second example, consider an embodiment with N=8, M=3, and the Hadamard matrix of size 8. In this case the unconstrained pre-code has 37=2187 elements and an unconstrained post-transformation alphabet of size (N−1)*(M−1)+1=15. Choosing a pre-code comprising all PAM-3 vectors of length 7 with at least one 0, one obtains a pre-code of size 2187−128=2059 which means that it is still possible to transmit 11 bits on the 8 communication wires. The constrained post-transformation alphabet has a size of (N−2)*(M−1)+1=13. The SNR increase is 20*log 10( 15/13)=1.24 dB.
In an alternative embodiment where k=4, i.e. in which it is required that at least four of the coordinates of (c1, c2, . . . , c7) be zero, this construction yields a pre-code of size 379 which is sufficient for transmission of 8 bits on the 8 wires. The constrained post-transformation alphabet size is in this case 3*(M−1)+1=7. The SNR increase is 20*log 10(15/7)=6.62 dB. This SNR increase was achieved by reducing the rate from 11 bits to 8 bits on 8 wires, i.e., by a reduction of the rate by roughly 38%.
Table I shows the SNR increase for embodiments N=8, M=5, and various values of k. In this case the unconstrained pre-code is capable of transmitting 16 bits over the 8 wire interface.
                   TABLE I           k = 0 k = 1 k = 2 k = 3 k = 4                               #bits 15 15 13 11 8     SNR 2.97 6.46 10.7 16.0 23.4     increase                 
It may be observed from the results of Table I that it is advantageous to increase the SNR by 6.46 dB (i.e. k=1) while losing 1 bit over the unconstrained transmission. Transmission with a pin efficiency of 1 (8 binary bits over the 8 wire interface) is also possible (k=4) and leads to an SNR increase of 23.4 dB.

Explicit Codespace Pruning

Although the ‘forcing to zero’ method requires only a fairly simple pre-coder, other methods of constraining the emitted set of codewords to avoid extreme alphabet values may provide more flexibility and/or a larger usable codespace.
As a first example, consider an embodiment in which the matrix A is the Hadamard matrix of order 8, and where M=2, i.e., the ci are +1 or −1. Without a pre-code, the size of the unconstrained post-transformation alphabet after the multiplication in Equation 1 is 8, and the unconstrained post-transformation alphabet (after normalization) consists of the values ±1, ± 5/7, ± 3/7, ± 1/7. There are exactly 16 vectors (0, c1, . . . , c7) leading to the alphabet elements ±1. These are the codewords of the [7,4,3] Hamming code (using binary antipodal modulation of the bits):
  [[1, 1, 1, 1, 1, 1, 1], [−1, −1, −1, 1, 1, 1, 1], [−1, 1, 1, −1, −1, 1, 1], [1, −1, −1, −1, −1, 1, 1], [1, −1, 1, −1, 1, −1, 1], [−1, 1, −1, −1, 1, −1, 1], [−1, −1, 1, 1, −1, −1, 1], [1, 1, −1, 1, −1, −1, 1], [−1, −1, 1, −1, 1, 1, −1], [1, 1, −1, −1, 1, 1, −1], [1, −1, 1, 1, −1, 1, −1], [−1, 1, −1, 1, −1, 1, −1], [−1, 1, 1, 1, 1, −1, −1], [1, −1, −1, 1, 1, −1, −1], [1, 1, 1, −1, −1, −1, −1], [−1, −1, −1, −1, −1, −1, −1]]. 
Thus, this method comprises identification of matrix multiplication results containing predetermined unacceptable alphabet values and the particular input values to that multiplication which results in generation of those codewords. The pre-code operation thus requires elimination (or equivalently, exclusion from the data-to-precode mapping) of those matrix multiplication input vectors. For descriptive purposes, this document refers to this method of pre-coding as “explicit codespace pruning”, as the pre-code explicitly avoids generating particular output vectors leading to unacceptable codewords.
Disallowing these vectors, the result of the multiplication in Equation 1 will belong to a constrained post-transformation alphabet of size 6, which after normalization can be viewed as ±1, ±⅗, ±⅕. The resulting vector signaling code is capable of transmitting one of 128−16=112 codewords in every transmission, and its SNR is 20*log10( 4/3)=2.5 dB better than the unconstrained case. The rate loss of this signaling code as compared to the unconstrained code is 7−log2(112)˜0.19, which is less than 3%.
Another example is provided by an embodiment in which N=8, and M=4. In this case A is again a Hadamard matrix of size 8. If the vectors (0, c1, . . . , c7) are unconstrained, then the size of the resulting unconstrained post-transformation alphabet is 22. By disallowing the same 16 vectors as in the previous example, the size of the constrained post-transformation alphabet is reduced to 20 and the SNR is increased by 20*log 10( 22/20)=0.83 dB. Disallowing another appropriate set of 112 vectors leads to a constrained post-transformation alphabet of size 18 and an increase of SNR by 20*log 10( 22/18)=1.74 dB. The set to be disallowed is obtained in the following way: We choose for the vector (0, c1, . . . , c7) all possible combinations except those in which (c1, . . . , c7) is one of the vectors of the [7,4,3] Hamming code above, or if (c1, . . . , c7) is obtained from such a vector by replacing any of the entries by ±⅓, and wherein the sign is chosen to be equal to the sign of the original entry (so, for example, the vector (−1, −⅓, −1, 1, 1, 1, 1) is disallowed since it is obtained from the vector (−1,−1,−1,1,1,1,1) by replacing the third entry by −⅓). Further improvements of the SNR are possible by disallowing a progressive number of possibilities for the vector (c1, . . . , c7): Disallowing another 448 vectors reduces the number of codewords of the precode to 47−448−112−16=15808, i.e., reduces the number of transmitted bits from 14 to 13.94, reduces the alphabet size to 16, and increases the SNR by 20*log 10( 22/16)=2.76 dB.
 FIG. 5 shows the evolution of the increase in SNR versus the number of transmitted bits if this process is continued down to an alphabet of size 6. In that case, about 7.8 bits are transmitted on the 8 wires, while the SNR is increased by 11.3 dB.
Explicit codespace pruning is not only applicable to PAM-M transmission when M is even. It can also be applied to the case of odd M. An example is provided by an embodiment in which N=8, and M=3. In this case A is again a Hadamard matrix of size 8. If the vectors (0, c1, . . . , c7) are unconstrained, then the size of the resulting unconstrained post-transformation alphabet is 15. By disallowing the same 16 vectors as in the example for M=2, the size of the constrained post-transformation alphabet is reduced to 13 and the SNR is increased by 20*log 10( 15/13)=1.24 dB, while the number of codewords is reduced from 37=2187 to 2171. The number of transmitted bits is reduced from 11.095 to 11.084. This same result is achieved by the zero-forcing method.
Disallowing a further set of 112 vectors leads to a constrained post-transformation alphabet of size 11 and an increase of SNR by 20*log 10( 15/11)=2.69 dB. The set to be disallowed is obtained in the following way: We choose for the vector (0, c1, . . . , c7) all possible combinations except those in which (c1, . . . , c7) is one of the vectors of the [7,4,3] Hamming code above, or if (c1, . . . , c7) is obtained from such a vector by replacing any of the entries by 0 (so, for example, the vector (−1, 0, −1, 1, 1, 1, 1) is disallowed since it is obtained from the vector (−1,−1,−1,1,1,1,1) by replacing the third entry by 0).
Further improvements of the SNR are possible by disallowing a progressive number of possibilities for the vector (c1, . . . , c7): Disallowing another 448 vectors reduces the number of codewords of the precode to 37−448−112−16=1611, i.e., reduces the number of transmitted bits from 11.095=log2(37) to 10.65, reduces the constrained post-transformation alphabet size to 9, and increases the SNR by 20*log 10(15/9)=4.44 dB.
 FIG. 6 shows the evolution of the increase in SNR versus the number of transmitted bits if this process is continued down to an alphabet of size 3. In that case, about 3.9 bits are transmitted on the 8 wires, while the SNR is increased by 13.98 dB.
Offline Codebook Generation
A generic diagram illustrating the previously described methods is shown as the block diagram of FIG. 7. Given the goal of producing encoded outputs 725 not containing codewords having extreme alphabet values, Input Data is pre-coded 710, producing an interim vector 715 which, when encoded 720 by a matrix operation, produces a satisfactory Encoded Data 725 result. The pre-coding step may be based on expanding the Input data into a vector containing forced zero values, mapping the input data into allowable vectors rather than disallowed vectors which would lead to unwanted codes, etc.
As shown in FIG. 8, the previously-described encoding methods may be incorporated in an offline analysis process 810. A constrained post-transformation alphabet is determined, being a proper subset of the original unconstrained post-transformation alphabet from which extreme alphabet values are excluded. All possible (i.e. encodable by matrix multiplication 710) values are enumerated and each such value encoded by matrix multiplication 710, producing all possible codewords 815. Each codeword 815 is tested 840 to verify every symbol of that codeword is a member of the constrained post-transformation alphabet. The resulting set of codewords passing this test 845 may then be used by a codebook encoder 850 which performs a simple codebook lookup, mapping each Input Data value to a selected codeword of the set of codewords 845, and outputting the selected codeword as its Encoded Data output.
Combination Designs
It will be apparent to one familiar with the art that the functional combinations and resulting circuit optimizations taught in the prior art may be equally well applied in combination with the present invention.
One embodiment illustrated as FIG. 4 utilizes a generalized comparator as taught by Holden I or Ulrich I to integrate linear combinatorial network 250 and PAM-X slicer 260 and obtain binary outputs representing the PAM-X values. In this integrated design, multiple input differential front end stage 410 (herein shown without limitation as paralleled differential amplifier elements sharing common loads as in Ulrich I) processes receiver signals A, B, C, and D, while each high gain digital comparator element of back end 420 (herein shown without limitation as a pair of high gain comparators) is provided with a reference or offset voltage appropriate to slice the combinatorial network outputs produced by 410 at one or more PAM-X threshold levels. In a preferred embodiment, multiple comparator outputs shown in FIG. 4 as SliceOut1 and SliceOut2 having reference level offsets Vth1 and Vth2 respectively, are associated with each integrated design instance. As will be obvious to one familiar with the art, any of a wide range of known PAM-X slicers, comparators, or threshold detectors may be used in place of the example comparators.
Embodiments
In accordance with at least one embodiment, a system comprises: a plurality of conductors configured to receive a set of input data bits; a pre-encoder configured to map the set of input data bits into symbols of a pre-code codeword of a pre-code, wherein the pre-code comprises a constrained set of vectors determined from a maximal set of vectors, and wherein the pre-code is associated with a constrained post-transformation alphabet comprising a portion of low magnitude symbol values selected from an unconstrained post-transformation alphabet associated with the maximal set of vectors; an encoder configured to generate a constrained-alphabet codeword of a constrained-alphabet vector signaling code, the constrained-alphabet codeword representing a transformation of the pre-code codeword with a first non-simple orthogonal matrix, wherein the constrained-alphabet codeword comprises symbols of the constrained post-transformation alphabet; and, a driver configured to transmit the constrained-alphabet codeword on a multi-wire communication bus.
In at least one embodiment, each vector in the constrained set comprises N−1 symbols, each symbol having a value selected from a constellation of PAM-M values, and the first non-simple orthogonal matrix has a size of N, wherein N and M are integers greater than or equal to 3. In at least one embodiment, the unconstrained post-transformation alphabet comprises (N−1)*(M−1)+1 possible symbol values. In at least one embodiment, M is odd, and wherein each vector in the constrained set comprises k symbols equal to 0, and the constrained post-transformation alphabet comprises (N−k−1)*(M−1)+1 possible symbol values, wherein k is an integer greater than or equal to 1.
In at least one embodiment, the constrained post-transformation alphabet comprises predetermined low magnitude values selected from the unconstrained post-transformation alphabet. In at least one embodiment, the portion of low magnitude symbol values have magnitudes under a predetermined threshold.
In at least one embodiment, the first non-simple orthogonal matrix is a Hadamard matrix. In at least one embodiment, the Hadamard matrix has a size of at least 4. In at least one embodiment, the pre-encoder comprises logic elements configured to map the set of input data bits to the pre-code codeword. In at least one embodiment, the constrained-alphabet vector signaling code is a balanced code. In at least one embodiment, the constrained-alphabet vector signaling code is ternary.
In at least one embodiment, the system further comprises a receiver, the receiver comprising: a multi-wire communication bus configured to receive the constrained-alphabet codeword; a linear combination network configured to obtain the pre-code codeword based on a transformation of the constrained-alphabet codeword by a second non-simple orthogonal matrix, the second non-simple orthogonal matrix based on the first non-simple orthogonal matrix; and, a detector configured to detect the symbols of the pre-code codeword, and generate a set of output data bits representative of the set of input data bits. In at least one embodiment, the detector is a PAM-M detector, the PAM-M detector comprising a plurality of comparators configured to generate a plurality of comparator outputs, each comparator associated with a respective reference voltage of a set of reference voltages, and wherein the plurality of comparator outputs correspond to the output data bits.
In at least one embodiment in accordance with FIG. 9, a method 900 comprises: receiving a set of input data bits on a plurality of conductors at step 902; mapping the set of input data bits into symbols of a pre-code codeword of a pre-code, the pre-code corresponding to a constrained set of vectors determined from a maximal set of vectors at step 904; generating a constrained-alphabet codeword comprising elements of a constrained alphabet, the constrained-alphabet codeword representing a transformation of the pre-code codeword with a non-simple orthogonal matrix, wherein the constrained alphabet comprises a number m of low magnitude symbol values, the number m less than a total number n of symbol values in an unconstrained alphabet generated by transforming the maximal set of vectors with the non-simple orthogonal matrix, and wherein n and m are integers, n greater than 1 and m greater than 2 at step 906; and, transmitting the constrained-alphabet codeword at step 908.
In at least one embodiment, each vector in the constrained set comprises N−1 symbols, each symbol having a value selected from a constellation of PAM-M values, and the first non-simple orthogonal matrix has a size of N, wherein N and M are integers greater than or equal to 3. In at least one embodiment, the unconstrained alphabet comprises n=(N−1)*(M−1)+1 possible symbol values. In at least one embodiment, M is odd, and wherein each vector in the constrained set comprises k symbols equal to 0, and the constrained alphabet comprises m=(N−k−1)*(M−1)+1 possible symbol values, wherein k is an integer greater than or equal to 1.
In at least one embodiment, the constrained alphabet comprises predetermined low magnitude values selected from the unconstrained alphabet. In at least one embodiment, each of the m low magnitude symbol values have magnitudes under a predetermined threshold.
In at least one embodiment, the non-simple orthogonal matrix is a Hadamard matrix. In at least one embodiment, the Hadamard matrix has a size of at least 4. In at least one embodiment, the constrained-alphabet vector signaling code is a balanced code. In at least one embodiment, the constrained-alphabet vector signaling code is ternary.
In at least one embodiment, the method further comprises: receiving the constrained-alphabet codeword on a plurality of conductors; obtaining the pre-code codeword based on a transformation of the constrained-alphabet codeword with a second non-simple orthogonal matrix, the second non-simple orthogonal matrix based on the first non-simple orthogonal matrix; and, generating a set of output data bits by a detector, wherein the set of output data bits is generated based on the pre-code codeword, and are representative of the set of input data bits. In at least one embodiment, generating the set of output data bits comprises forming a plurality of comparator outputs using a plurality of comparators, each comparator associated with a respective reference voltage of a set of reference voltages.
The examples presented herein describe the use of vector signaling codes for communication over a point-to-point wire interconnection. However, this should not been seen in any way as limiting the scope of the described invention. The methods disclosed in this application are equally applicable to other interconnection topologies and other communication media including optical, capacitive, inductive, and wireless communications, which may rely on any of the characteristics of the described invention, including minimization of reception or detection resources by selective modification or subset selection of code space. The methods disclosed in this application are equally applicable to embodiments where the encoded information is stored and subsequently retrieved, specifically including dynamic and static random-access memory, non-volatile memory, and flash programmable memory. Descriptive terms such as “voltage” or “signal level” should be considered to include equivalents in other measurement systems, such as “optical intensity”, “RF modulation”, “stored charge”, etc.
As used herein, the term “physical signal” includes any suitable behavior and/or attribute of a physical phenomenon capable of conveying information. Physical signals may be tangible and non-transitory. “Code” and “codeword” may represent physically-representable constructs, capable of being recorded in physical media, embodied as physical devices, and communicated as measurable physical signals over physical interconnections.

I claim:
 
1. A method comprising:
generating a codebook using an offline process prior to system initialization, the codebook comprising a plurality of constrained-alphabet codewords of a constrained-alphabet code, the plurality of constrained-alphabet codewords being a subset of a maximal set of vectors having an associated unconstrained alphabet;
obtaining a set of input bits;
mapping the set of input bits to a set of symbols corresponding to a constrained-alphabet codeword having symbol values selected from a constrained alphabet having at least three values, the constrained alphabet having a fewer number of symbol values than the unconstrained alphabet, wherein mapping the set of input bits comprises selecting a corresponding constrained-alphabet codeword from the codebook; and
transmitting each symbol of the set of symbols over a respective wire of a multi-wire bus.


  
2. The method of claim 1, wherein the constrained-alphabet code is generated by selecting, from the maximal set of vectors, codewords having symbol values within the constrained alphabet, the maximal set of vectors representing a transformation of a plurality of PAM-M codewords with a transformation matrix of size N, wherein M is an integer greater than 1 and N is an integer power of 2 greater than 1.

  
3. The method of claim 2, wherein each of the plurality of PAM-M codewords has at least k zero elements, wherein k is an integer greater than or equal to 1.

  
4. The method of claim 3, wherein the constrained alphabet is less than or equal to (N−k−1)·(M−1)+1.

  
5. The method of claim 2, wherein M=2, and wherein each PAM-M codeword has symbol values selected from the group (+1, −1).

  
6. The method of claim 2, wherein M=3, and wherein each PAM-M codeword has symbol values selected from the group (+1, 0, −1).

  
7. The method of claim 2, wherein the transformation matrix is a Hadamard matrix.

  
8. The method of claim 1, wherein the codebook comprises at least two constrained-alphabet codes.

  
9. The method of claim 8, wherein a constrained-alphabet code is selected at system initialization.

  
10. An apparatus comprising:
a codebook generator configured to generate a codebook using an offline process prior to system initialization, the codebook comprising a plurality of constrained-alphabet codewords of a constrained-alphabet code, the plurality of constrained-alphabet codewords being a subset of a maximal set of vectors having an associated unconstrained alphabet;
a codebook encoder configured to obtain a set of input bits, and to responsively map the set of input bits to a set of symbols corresponding to a constrained-alphabet codeword having symbol values selected from a constrained alphabet having at least three values, the constrained alphabet having a fewer number of symbol values than the unconstrained alphabet, wherein the codebook encoder is configured to select, for the set of input bits, a corresponding constrained-alphabet codeword from the codebook; and
a plurality of drivers configured to transmit each symbol of the set of symbols over a respective wire of a multi-wire bus.


  
11. The apparatus of claim 10, wherein the codebook generator is configured to generate the constrained-alphabet code by selecting, from the maximal set of vectors, codewords having symbol values within the constrained alphabet, the maximal set of vectors representing a transformation of a plurality of PAM-M codewords with a transformation matrix of size N, wherein M is an integer greater than 1 and N is an integer power of 2 greater than 1.

  
12. The apparatus of claim 11, wherein each of the plurality of PAM-M codewords has at least k zero elements, wherein k is an integer greater than or equal to 1.

  
13. The apparatus of claim 12, wherein the constrained alphabet is less than or equal to (N−k−1)·(M−1)+1.

  
14. The apparatus of claim 11, wherein M=2, and wherein each PAM-M codeword has symbol values selected from the group (+1, −1).

  
15. The apparatus of claim 11, wherein M=3, and wherein each PAM-M codeword has symbol values selected from the group (+1, 0, −1).

  
16. The apparatus of claim 11, wherein the transformation matrix is a Hadamard matrix.

  
17. The apparatus of claim 10, wherein the codebook comprises at least two constrained-alphabet codes.

  
18. The apparatus of claim 17, wherein the codebook encoder is further configured to select a constrained-alphabet code at system initialization.
# US10091035B2 - US10091035B2 - Methods and systems for high bandwidth communications interface 
        - Google Patents

## Details

* Date: 2013-04-16
* Inventor: Kandou Labs SA
* Beneficiary: John Fox, Brian Holden, Ali Hormati, Peter Hunt, John D. Keay, Amin Shokrollahi, Richard Simpson, Anant Singh, Andrew Kevin John Stewart, Giuseppe Surace, Roger Ulrich
## Other patents

### Backwards
 * US668687A
 *US780883A
 *US3196351A
 *US3636463A
 *US3939468A
 *US4163258A
 *US4181967A
 *US4206316A
 *US4276543A
 *US4486739A
 *US4499550A
 *US4722084A
 *US4772845A
 *US4774498A
 *US4864303A
 *US4897657A
 *US4974211A
 *US5017924A
 *US5053974A
 *US5166956A
 *US5168509A
 *US5266907A
 *US5283761A
 *US5287305A
 *US5311516A
 *US5331320A
 *US5412689A
 *US5449895A
 *US5459465A
 *US5461379A
 *US5511119A
 *US5510736A
 *US5553097A
 *US5566193A
 *US5599550A
 *US5626651A
 *US5629651A
 *US5659353A
 *US5727006A
 *US5748948A
 *US5802356A
 *US5825808A
 *US5856935A
 *US5875202A
 *US5945935A
 *US5949060A
 *US5982954A
 *US5995016A
 *US5999016A
 *US6005895A
 *US6084883A
 *US6119263A
 *US6172634B1
 *US6175230B1
 *US6232908B1
 *US20010006538A1
 *US6278740B1
 *US6316987B1
 *US20010055344A1
 *US6346907B1
 *US20020034191A1
 *US20020044316A1
 *US6378073B1
 *US6384758B1
 *US20020057592A1
 *US6398359B1
 *US6404820B1
 *US6417737B1
 *US6433800B1
 *US6452420B1
 *US20020154633A1
 *US6473877B1
 *US20020163881A1
 *US20020167339A1
 *US6483828B1
 *US20020174373A1
 *US20020181607A1
 *US6509773B2
 *US20030016770A1
 *US20030016763A1
 *US6522699B1
 *US20030046618A1
 *US6556628B1
 *US20030085763A1
 *US6563382B1
 *JP2003163612A
 *US20030146783A1
 *US6621427B2
 *US20030174023A1
 *US6624699B2
 *US20030185310A1
 *US6650638B1
 *US20030218558A1
 *US6661355B2
 *US6664355B2
 *US6690739B1
 *US20040027185A1
 *US6766342B2
 *US20040146117A1
 *US6772351B1
 *US20040155802A1
 *US20040161019A1
 *US20040169529A1
 *US6839587B2
 *US6839429B1
 *WO2005002162A1
 *US6854030B2
 *US6865236B1
 *US6865234B1
 *US20050063493A1
 *US6876317B2
 *US20050134380A1
 *US6927709B2
 *US20050174841A1
 *US20050195000A1
 *US20050201491A1
 *US20050213686A1
 *US20050220182A1
 *US6954492B1
 *US6963622B2
 *US6972701B2
 *US6973613B2
 *US20050270098A1
 *US6976194B2
 *US6990138B2
 *US6991038B2
 *US6993311B2
 *US6999516B1
 *US20060036668A1
 *US7023817B2
 *US7039136B2
 *US20060097786A1
 *US20060103463A1
 *US7053802B2
 *US20060120486A1
 *US20060126751A1
 *US20060133538A1
 *US20060140324A1
 *US7080288B2
 *US20060159005A1
 *US7082557B2
 *US7085153B2
 *US20060233291A1
 *US7127003B2
 *CN1864346A
 *US7142612B2
 *US7142865B2
 *US20070001723A1
 *US20070002954A1
 *US7164631B2
 *US7167019B2
 *US20070030796A1
 *US7176823B2
 *US7180949B2
 *US7199728B2
 *US20070103338A1
 *US20070121716A1
 *US7231558B2
 *US20070182487A1
 *US20070201546A1
 *US20070204205A1
 *US7269212B1
 *US7269130B2
 *US20070263711A1
 *US20070283210A1
 *US20080007367A1
 *US20080012598A1
 *US7336112B1
 *US7335976B2
 *US7339990B2
 *US7346819B2
 *US7348989B2
 *US7356213B1
 *US7358869B1
 *US7362697B2
 *US7366942B2
 *US20080104374A1
 *US7370264B2
 *US7372390B2
 *EP1926267A1
 *US7389333B2
 *US20080159448A1
 *US7397302B2
 *US7400276B1
 *US20080192621A1
 *US7462956B2
 *US20080317188A1
 *US7496162B2
 *US20090059782A1
 *US20090115523A1
 *US7535957B2
 *US7539532B2
 *US20090154604A1
 *CN101478286A
 *WO2009084121A1
 *US20090195281A1
 *US7599390B2
 *US20090262876A1
 *US7613234B2
 *US7616075B2
 *US7620116B2
 *US7633850B2
 *US20090316730A1
 *US7639596B2
 *US20090323864A1
 *US7650525B1
 *US7656321B2
 *US20100046644A1
 *WO2010031824A1
 *US20100081451A1
 *US7694204B2
 *US7698088B2
 *US7697915B2
 *US7706456B2
 *US7706524B2
 *US20100148819A1
 *US20100180143A1
 *US7768312B2
 *US20100215112A1
 *US20100215087A1
 *US7787572B2
 *US20100235673A1
 *US7804361B2
 *US7808456B2
 *US20100271107A1
 *US20100283894A1
 *US20100296556A1
 *US7841909B2
 *US20100309964A1
 *US7869546B2
 *US7869497B2
 *US20110014865A1
 *US7882413B2
 *US20110028089A1
 *US20110032977A1
 *US7899653B2
 *US20110051854A1
 *US20110072330A1
 *US20110074488A1
 *US20110084737A1
 *US7933770B2
 *US20110103508A1
 *US8000664B2
 *US20110228864A1
 *WO2011119359A2
 *US8030999B2
 *US8036300B2
 *US8050332B2
 *US20110268225A1
 *US8055095B2
 *US8064535B2
 *US20110299555A1
 *US20110302478A1
 *US8085172B2
 *US20110317559A1
 *US8106806B2
 *US8149906B2
 *US20120082203A1
 *US8159376B2
 *US8180931B2
 *US8185807B2
 *US20120133438A1
 *US8199849B2
 *US8199863B2
 *US20120152901A1
 *US20120161945A1
 *US8218670B2
 *US8233544B2
 *US8245094B2
 *US20120213299A1
 *US8253454B2
 *US8279094B2
 *US8279745B2
 *US20120257683A1
 *US8289914B2
 *US8295336B2
 *US8295250B2
 *US8310389B1
 *US8341492B2
 *US20130010892A1
 *US20130013870A1
 *US8359445B2
 *US8365035B2
 *EP2039221B1
 *US8406316B2
 *US8429492B2
 *US8429495B2
 *US20130106513A1
 *US8437440B1
 *US20130114663A1
 *US20130114519A1
 *US8443223B2
 *US8442099B1
 *US20130129019A1
 *US20130147553A1
 *US8472513B2
 *US20130188656A1
 *US8498368B1
 *US20130195155A1
 *US20130202065A1
 *US20130215954A1
 *US8520348B2
 *US8547272B2
 *US20130259113A1
 *US20130271194A1
 *US8578246B2
 *US8588254B2
 *US20130307614A1
 *US8593305B1
 *US20130314142A1
 *US20130315501A1
 *US8604879B2
 *US8602643B2
 *US20130346830A1
 *US8620166B2
 *US8638241B2
 *US8643437B2
 *US8649840B2
 *US8649556B2
 *US8649460B2
 *US8674861B2
 *US8687968B2
 *US8718184B1
 *US20140159769A1
 *US8755426B1
 *US20140177696A1
 *US8773964B2
 *US8782578B2
 *US8780687B2
 *US8831440B2
 *US20140266440A1
 *US20140269130A1
 *US8841936B2
 *US8879660B1
 *US8898504B2
 *US8938171B2
 *US8951072B2
 *US20150049798A1
 *US8975948B2
 *US20150070201A1
 *US20150078479A1
 *US8989317B1
 *US9036764B1
 *US20150146771A1
 *US9059816B1
 *US9069995B1
 *US9077386B1
 *US9083576B1
 *US9093791B2
 *US9100232B1
 *US9124557B2
 *US20150249559A1
 *US9148087B1
 *US9152495B2
 *US9172412B2
 *US9178503B2
 *US9183085B1
 *US20150333940A1
 *US9197470B2
 *US20150349835A1
 *US20150380087A1
 *US20150381232A1
 *US20160020796A1
 *US20160020824A1
 *US20160036616A1
 *US9281785B2
 *US9288082B1
 *US9292716B2
 *US9300503B1
 *US9306621B2
 *US9331962B2
 *US9374250B1
 *US9432298B1
 *US20160261435A1
 *US9455744B2
 *US9455765B2
 *US9479369B1
 *US9634797B2
 *US20170310456A1
 *US20170317449A1
 *US20170317855A1
### Forward
 * 
## Abstract

Abstract

Systems and methods are described for transmitting data over physical channels to provide a high bandwidth, low latency interface between a transmitting device and a receiving device operating at high speed with low power utilization. Communication is performed using group signaling over sets of four wires using a vector signaling code, where each wire of a set carries a low-swing signal that may take on one of four signal values. Topologies and designs of wire sets are disclosed with preferred characteristics for group signaling communications.



Systems and methods are described for transmitting data over physical channels to provide a high bandwidth, low latency interface between a transmitting device and a receiving device operating at high speed with low power utilization. Communication is performed using group signaling over sets of four wires using a vector signaling code, where each wire of a set carries a low-swing signal that may take on one of four signal values. Topologies and designs of wire sets are disclosed with preferred characteristics for group signaling communications.

CROSS REFERENCES
This application is a continuation of U.S. application Ser. No. 14/253,584, FILED Apr. 15, 2014, entitled “METHODS AND SYSTEMS FOR HIGH BANDWIDTH COMMUNICATIONS INTERFACE”, which claims the benefit of U.S. provisional application No. 61/812,667 filed on Apr. 16, 2013, the contents of which are incorporated herein by reference in their entirety for all purposes.
The following references are herein incorporated by reference in their entirety for all purposes:
U.S. Patent Publication No. 2011/0268225 of U.S. patent application Ser. No. 12/784,414, filed May 20, 2010, naming Harm Cronie and Amin Shokrollahi, entitled “Orthogonal Differential Vector Signaling” (hereinafter “Cronie I”);
U.S. Patent Publication No. 2011/0302478 of U.S. patent application Ser. No. 12/982,777, filed Dec. 30, 2010, naming Harm Cronie and Amin Shokrollahi, entitled “Power and Pin Efficient Chip-to-Chip Communications with Common-Mode Resilience and SSO Resilience” (hereinafter “Cronie II”);
U.S. patent application Ser. No. 13/030,027, filed Feb. 17, 2011, naming Harm Cronie, Amin Shokrollahi and Armin Tajalli, entitled “Methods and Systems for Noise Resilient, Pin-Efficient and Low Power Communications with Sparse Signaling Codes” (hereinafter “Cronie III”);
U.S. Provisional Patent Application No. 61/753,870, filed Jan. 17, 2013, naming John Fox, Brian Holden, Peter Hunt, John D Keay, Amin Shokrollahi, Richard Simpson, Anant Singh, Andrew Kevin John Stewart, and Giuseppe Surace, entitled “Methods and Systems for Chip-to-chip Communication with Reduced Simultaneous Switching Noise” (hereinafter called “Fox I”); and
U.S. Provisional Patent Application No. 61/763,403, filed Feb. 11, 2013, naming John Fox, Brian Holden, Ali Hormati, Peter Hunt, John D Keay, Amin Shokrollahi, Anant Singh, Andrew Kevin John Stewart, Giuseppe Surace, and Roger Ulrich, entitled “Methods and Systems for High Bandwidth Chip-to-Chip Communications Interface” (hereinafter called “Fox II”).
U.S. Provisional Patent Application No. 61/773,709, filed Mar. 6, 2013, naming John Fox, Brian Holden, Peter Hunt, John D Keay, Amin Shokrollahi, Andrew Kevin John Stewart, Giuseppe Surace, and Roger Ulrich, entitled “Methods and Systems for High Bandwidth Chip-to-Chip Communications Interface” (hereinafter called “Fox III”).
BACKGROUND
In communication systems, information may be transmitted from one physical location to another. Furthermore, it is typically desirable that the transport of this information is reliable, is fast and consumes a minimal amount of resources. One of the most common information transfer media is the serial communications link, which may be based on a single wire circuit relative to ground or other common reference, multiple such circuits relative to ground or other common reference, or multiple circuits used in relation to each other.
In the general case, a serial communications link is used over multiple time periods. In each such time period, a signal or signals over the link represents, and thus conveys, some amount of information typically measured in bits. Thus, at a high level, a serial communications link connects a transmitter to a receiver and the transmitter transmits a signal or signals each time period, the receiver receives the signal or signals (or at least something close, as noise and other effects might keep the received signal from being identical to the sent signal). The information being conveyed by the transmitter is “consumed” by the transmitter, and representative signals are generated. The receiver attempts to determine the conveyed information from the signals it receives. In the absence of overall errors, the receiver can output exactly the bits that were consumed by the transmitter.
The optimum design of a serial communications link often depends on the application for which it is used. In many cases, there are trade-offs between various performance metrics, such as bandwidth (number of bits that can be conveyed per unit time and/or per period), pin efficiency (number of bits or bit equivalents that can be conveyed at one time divided by the number of wires required for that conveyance), power consumption (units of energy consumed by the transmitter, signal logic, receiver, etc. per bit conveyed), SSO resilience and cross-talk resilience, and expected error rate.
An example of a serial communications link is a differential signaling (DS) link. Differential signaling operates by sending a signal on one wire and the opposite of that signal on a paired wire; the signal information is represented by the difference between the wires rather than their absolute values relative to ground or other fixed reference. Differential signaling enhances the recoverability of the original signal at the receiver over single ended signaling (SES), by cancelling crosstalk and other common-mode noise. There are a number of signaling methods that maintain the desirable properties of DS while increasing pin-efficiency over DS. Many of these attempts operate on more than two wires simultaneously, using binary signals on each wire, but mapping information in groups of bits.
Vector signaling is a method of signaling. With vector signaling, pluralities of signals on a plurality of wires are considered collectively although each of the plurality of signals may be independent. Each of the collective signals is referred to as a component and the number of plurality of wires is referred to as the “dimension” of the vector. In some embodiments, the signal on one wire is entirely dependent on the signal on another wire, as is the case with DS pairs, so in some cases the dimension of the vector may refer to the number of degrees of freedom of signals on the plurality of wires instead of the number of wires in the plurality of wires.
With binary vector signaling, each component takes on a coordinate value (or “coordinate”, for short) that is one of two possible values. As an example, eight SES wires may be considered collectively, with each component/wire taking on one of two values each signal period. A “code word” of this binary vector signaling is one of the possible states of that collective set of components/wires. A “vector signaling code” or “vector signaling vector set” is the collection of valid possible code words for a given vector signaling encoding scheme. A “binary vector signaling code” refers to a mapping and/or set of rules to map information bits to binary vectors. In the example of eight SES wires, where each component has a degree of freedom allowing it to be either of the two possible coordinates, the number of code words in the collection of code words is 2^8, or 256.
With non-binary vector signaling, each component has a coordinate value that is a selection from a set of more than two possible values. A “non-binary vector signaling code” refers to a mapping and/or set of rules to map information bits to non-binary vectors.
Examples of vector signaling methods are described in Cronie I, Cronie II, Cronie III, Fox I, Fox II, and Fox III.
BRIEF SUMMARY
A transmitter and receiver can communicate using a serial communications link, wherein the serial communications link uses signaling that is vector signaling, balanced and can be detected using a plurality of comparators having inputs coupled to differing combinations of sums of components of a vector signal.
The number of components can be four, or more or less than four. The number of coordinate values for a component can be four, or more or less than four. For example, a link might use four components with four possible coordinate values, a high value, a low value, and inverses of the high and low values, such that a signal having the high value cancels out three signals having the inverse of the low value and a signal having the inverse of the high value cancels out three signals having the low value and, in this manner, the link can convey three bits in a signal period using those four components by mapping the eight possible three bit combinations onto the eight vector code words represented by the four permutations of one high value and three inverses of the low value plus the four permutations of the inverse of one high value and three low values. In a more specific embodiment, the high and low values are voltage values and relative to a reference, the high value and its inverse have the same magnitude but opposite signs, the low value and its inverse have the same magnitude but opposite signs, and the high value has a magnitude three times the low value.
In a receiver, some number of comparators compares sums of signals. In a specific embodiment, there are three comparators, each which compares sums of two of the received signals and collectively the output of the three comparators identify the three bits encoded by the signals. Signal equalization as commonly provided using Decision Feedback Equalization techniques may be advantageously applied at this receive comparison stage, or may more conventionally be applied to the received wire signals.
In accordance with at least one embodiment of the invention, processes and apparatuses provide for transmitting data over physical channels to provide a high speed, low latency interface providing high total bandwidth at low power utilization, such as to interconnect integrated circuit chips in a multi-chip system. In some embodiments, different voltage, current, etc. levels are used for signaling and more than two levels may be used, such as a ternary vector signaling code wherein each wire signal has one of three values, or a quaternary signaling system wherein each wire signal has one of four values.
This Brief Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Brief Summary is not intended to identify key or essential features of the claimed subject matter, nor is it intended to be used as an aid in determining the scope of the claimed subject matter. Other objects and/or advantages of the present invention will be apparent to one of ordinary skill in the art upon review of the Detailed Description and the included drawings.

BRIEF DESCRIPTION OF THE DRAWINGS
Various embodiments in accordance with the present disclosure will be described with reference to the drawings. Same numbers are used throughout the disclosure and figures to reference like components and features.
 FIG. 1 is a block diagram of an example system comprising a transmitting device, interconnection, and receiving device, in accordance with at least one embodiment of the invention.
 FIG. 2 shows several physical channel topologies suited for use with the described signal coding in at least one embodiment in accordance with the invention.
 FIGS. 3A and 3B illustrate different transmission modes in differential and H4 encoded communications.
 FIG. 4 is a block diagram of a H4 encoder and transmitter of the FIG. 1 system, in accordance with at least one embodiment of the invention.
 FIGS. 5A and 5B show block diagrams for the receiver and H4 decoder components of the FIG. 1 system utilizing a single process phase and multiple processing phases, in accordance with at least one embodiment of the invention.
 FIG. 6 is a chart shown example transmit wire values for each transmit data value, and corresponding example receive comparator outputs and receive data words, in accordance with at least one embodiment of the invention.
 FIGS. 7A and 7B show block diagrams of receivers incorporating two approaches to DFE compensation, in accordance with at least one embodiment of the invention.
 FIGS. 8A and 8B show individual wire signals of a transmitted H4 code and the combined signaling of all wires depicting the use of two of the four signal levels per transmit interval, in accordance with at least one embodiment of the invention.
 FIG. 9 is a block diagram illustrating the method of claims 1-5.

DETAILED DESCRIPTION
Despite the increasing technological ability to integrate entire systems into a single integrated circuit, multiple chip systems and subsystems retain significant advantages. The physical infrastructure to support high-bandwidth chip-to-chip connectivity is available, if the power, complexity, and other circuit implementation issues for such interfaces could be resolved.
For purposes of description and without limitation, example embodiments of at least some aspects of the invention herein described assume a systems environment of (1) at least one point-to-point communications interface connecting two integrated circuit chips representing a transmitter and a receiver, (2) wherein the communications interface is supported by an interconnection group of four high-speed transmission line signal wires providing medium loss connectivity at, as an example, 18.75 GHz (37.3 GigaSymbols/second) without excessive ripple loss characteristics or reflections, (3) the interconnection group of signal wires displaying low intra-ensemble skew, and (4) the communications interface operating at the example signaling rate of 37.3 GigaSymbols/second, delivering an aggregate throughput of approximately 112 gigabits/sec over the four wire circuit.
As subsequently described, at least one embodiment of the invention uses low signal swing current mode logic pin drivers and interconnection wiring terminated at both transmitter and receiver.
Physical Channel Wiring
Several example physical channel topologies in accordance with at least one embodiment of the invention are shown in FIG. 2.
Example configuration 201 illustrates in cross-section a quad-box stripline, with four signal conductors 202 embedded in dielectric medium 203 between ground planes 204. In some embodiments, vias 205 are incorporated to interconnect ground planes 204. In some embodiments, the locations of signal conductors 202 are modified by introducing periodic horizontal position offsets so as to provide more uniform characteristics for the four signal paths. As one example, the upper two signal conductors of 202 may be shifted left as the lower two signal conductors of 202 are simultaneously shifted right as illustrated in 210, and then the direction of these shifts reversed on each subsequent offset cycle, with the period and extent of the offsets chosen to provide more uniform characteristics for the four signal paths.
Example configuration 211 illustrates in cross-section a quadax cable, with four signal conductors 212 embedded in dielectric medium 213 surrounded or essentially surrounded by conductive shield 214. The external profile of the dielectric medium and conductive shield will in practice be a balance between manufacturing simplicity (e.g. a round profile as in conventional coax cable) and optimized transmission characteristics (e.g. the square or rectangular shape of 201) as is suggested by the profile provided for illustrative purposes at 214. As with the previous example, periodic perturbations of the inter-wire spacing of conductors 212 and/or their locations may be made to provide more uniform characteristics for the four signal paths.
Example configuration 221 shows a twisted quad cable, where individually insulated signal conductors 222 are twisted as a group around a common axis, either with or without a central insulating strand 223 to control overall diameter and spacing. Some embodiments may further optionally incorporate at least one of a central conductive neutral wire, surrounding insulation layer, and surrounding conductive shield layer to allow additional control over impedance characteristics and/or noise isolation.
It will be apparent to one familiar with the art that each example of FIG. 2 utilizes three-dimensional structuring of signal conductors to provide essentially equal impedance characteristics for each of the four signal wires, and also essentially equal inter-wire coupling characteristics among the four signal wires. These characteristics facilitate signal propagation modes providing effectively equal propagation velocity for signals on each wire, as well as effectively equal attenuation and frequency response characteristics. Comparable transmission characteristics may also be provided by other known cable designs, including braid twisted quad conductor cable, quad micro-coax cable, etc.
Other known cable designs including quad microstripline, dual pair microstripline, and dual twisted pair may also be usable with the described invention under some conditions. With such cables, not all signal propagation modes for the subsequently described H4 coded signals are identical, typically with one of the three major propagation modes experiencing reduced receive signal levels and slower propagation velocity. Some embodiments of the invention provide compensation for these effects through additional amplification of received signals of the degraded mode and delayed sampling of that mode's received signal values. Other embodiments provide a legacy communication capability, where signals are communicated using conventional dual differential transmission and reception, with reduced aggregate communications throughput.
Example signal levels, signal frequencies, and physical dimensions described herein are provided for purposes of explanation, and are not limiting. Other embodiments of the invention may utilize different signaling levels, connection topology, termination methods, and/or other physical interfaces, including optical, inductive, capacitive, or electrical interconnection. Similarly, examples based on unidirectional communication from transmitter to receiver are presented for clarity of description; combined transmitter-receiver embodiments and bidirectional communication embodiments are also explicitly in accordance with the invention.
Encoding Information using Hadamard Transforms
The Hadamard Transform, also known as the Walsh-Hadamard transform, is a square matrix of entries +1 and −1 so arranged that both all rows and all columns are mutually orthogonal. Hadamard matrices are known for all sizes 2N as well as for selected other sizes. In particular, the descriptions herein rely on 2×2 and 4×4 Hadamard matrices.
The order 2 Hadamard matrix is:
        H 2  =  [    1   1     1    - 1     ]      (  Eqn .     ⁢ 1  )       
and conventional differential encoding of one bit A may be obtained by multiplying A by the Hadamard matrix H2 to obtain values for the resulting output signals W and X. It will be apparent to one familiar with the art that multiplication times the upper vector of the matrix corresponds to introduction of a positive or negative common-mode signal onto W and X, a transmission mode not generally used in practice on differential circuits, while multiplication times the lower vector of the matrix produces the familiar differential signals of {+1, −1} for A positive, and {−1, +1} for A negative. This is illustrated in FIG. 3A, where the two signal lines 301 and 302 representing the signals W and X carry the encoded transmission mode 303 representing the {+1, −1} vector multiplied by the encoded bit A.

The order 4 Hadamard matrix is:
        H 4  =  [     + 1     + 1     + 1     + 1       + 1     - 1     + 1     - 1       + 1     + 1     - 1     - 1       + 1     - 1     - 1     + 1     ]      (  Eqn .     ⁢ 2  )       
and encoding of the three bits A, B, C may be obtained by multiplying those bits times the Hadamard matrix H4 to obtain four output values. As in the previous example, the uppermost vector corresponds to common mode signaling, which is not used herein, with the next three vectors being used to encode bits A, B, and C respectively into outputs W, X, Y, Z. This is graphically illustrated in FIG. 3B, where the four signal line 311, 312, 313, and 314 represent the signals W, X, Y, Z respectively in each illustration, with the three illustrations representing the three distinct transmission modes representing the bit A multiplied by the vector {+1, −1, +1, −1} at 320, the bit B multiplied by the vector {+1, +1, −1, −1} at 330, and the bit C multiplied by the vector {+1, −1, −1, +1} at 340.

As in the example of FIG. 3A, the ovals in FIG. 3B identify signal pairs carrying opposing values. However, unlike in the previous example where only one transmission mode 303 was available for use, in the example of FIG. 3B each of the three illustrated modes 320, 330, and 340 may be used simultaneously to transmit A, B, and C. Thus, the observed signal levels on W, X, Y, Z used in such manner correspond to the sums of the three modes.
One familiar with the art will note that all possible values of A, B, C encoded in this manner result in mode summed values for W, X, Y, Z which are balanced; that is, summing to the constant value zero. If the mode summed values for W, X, Y, Z are scaled such that their maximum absolute value is 1 (that is, the signals are in the range +1 to −1 for convenience of description,) it will be noted that all achievable values are permutations of the values {+1, −1/3, −1/3, −1/3} or of the values {−1, 1/3, 1/3, 1/3}. These are called the code words of the vector signaling code H4.
H4 Code
As used herein, “H4” code, also called Ensemble NRZ code, refers to a vector signaling code and associated logic for such code wherein a transmitter consumes three bits and outputs signals on four wires in each symbol period. In some embodiments, parallel configurations comprising more than one group may be used, with each group comprising three bits transmitted on four wires per symbol period and an H4 encoder and an H4 decoder per group. With an H4 code, there are four signal wires and four possible coordinate values, represented herein as +1, +1/3, −1/3, and −1. The H4 code words are balanced, in that each code word is either one of the four permutations of (+1, −1/3, −1/3, −1/3) or one of the four permutations of (−1, +1/3, +1/3, +1/3), all such permutations summing to the equivalent of a zero value. H4 encoded signal waveforms are shown in FIG. 8A. It should be noted that although the constellation of all code words utilizes four distinct signal levels, only two signal levels will be utilized in any one code word, as is illustrated by a superposition of all four signal waveforms, as shown in FIG. 8B.
In a specific embodiment, a +1 might be sent as a signal using an offset of 200 mV, while a −1 is sent as a signal using an offset of −200 mV, a +1/3 is sent as a signal using an offset of 66 mV, and a −1/3 is sent as a signal using an offset of −66 mV, wherein the voltage levels are with respect to a fixed reference. Note that the average of all of the signals sent (or received, disregarding asymmetric effects of skew, crosstalk, and attenuation) in any single time interval regardless of the code word represented is “0”, corresponding to the offset voltage. There are eight distinct code words in H4, which is sufficient to encode three binary bits per transmitted symbol interval.
Other variants of the H4 coding described above exist as well. The signal levels are given as examples, without limitation, and represent incremental signal values from a nominal reference level.
Encoder and Transmitter
 FIG. 4 is a block diagram for one embodiment of the H4 encoder and transmitter components of the FIG. 1 system in accordance with the invention. This embodiment uses source- and destination-terminated current mode logic drivers with reduced signal swing.
High-speed communications embodiments often exceed the performance capabilities of a single communications circuit instance. As an example of how such a limitation is overcome, FIG. 4 shows as an example a 4:1 mux architecture that supports a line rate of as much as 4× the capabilities of a single circuit instance in the same process technology. Each of the processing stages 420 and 430 are embodied as four distinct instances, each instance processing source data into symbol data for one transmission interval. Any number of phases may be used, from a single phase performing all operations, to sixteen or more, with each of such multiple phases possibly also extending over a greater or lesser portion of the described transmission system than this example.
In one embodiment in accordance with the invention, source data, which may be subjected to scrambling, encryption, or encapsulation beyond the scope of this disclosure, is provided at 405. Multiplexer 410 sequentially distributes consecutive source data elements to the four encoding phases, and multiplexer 440 sequentially combines the resulting four encoded results into a single data stream for transmission. One embodiment accepts source data in twelve bit increments, which is then distributed as four three-bit portions to the four processing phases, and subsequently combined to produce the higher rate transmitted stream. Each H4 encoder 420 maps three bits of user data to one H4 code word, with the results buffered in flip-flops 430. At each symbol interval, one buffered H4 code word is selected, and then converted to the chosen wire signal levels by line drivers 450 for transmission on interconnection 460. This allows for transmission rates to be multiples of the processing rates of a single encoder or decoder.
The specific mapping function between three bits of source data and a specific H4 code word may be chosen for implementation convenience, as will be subsequently described.
Receiver and Decoder
The complementary receiver and decoder for the described H4 transmitter system perform a number of operations. The interconnection wires are terminated in a matched impedance, conventional amplification and filtration may be applied to compensate for channel attenuation, received signal levels corresponding to the symbol representations of the H4 code are measured, symbols interpreted as valid code words of the H4 code, and the detected code words mapped back to received data.
At least one embodiment in accordance with the invention combines at least some aspects of these receiver and decoder operations for efficiency. One embodiment in accordance with the invention shown in FIGS. 5A and 5B incorporate a differential comparator circuit operating on multiple inputs, summing the received signal values on two selected wires, summing the received signal values on the remaining two wires, and outputting a comparison of the two summed results. Such a multi-input comparator requires no fixed signal level reference and can provide a good level of common-mode noise rejection, in a circuit combining elements of line receiver and H4 code word detection operations. At least one embodiment in accordance with the invention further incorporates line equalization and amplification with the line receiver and code word detection operations.
Three instances of such multi-input comparator circuits operating on permutations of the same four input signals are sufficient to detect all code words of H4. That is, given a multi-input comparator that performs the operation

R=(J+L)−(K+M)  (Eqn. 3)

where J, K, L, M are variables representing the four input signals values, then as one example and without limitation, the input permutations producing the three results R0, R1, R2 based on the equations

R 0=(W+Y)−(X+Z)  (Eqn. 4)

R 1=(Y+Z)−(W+X)  (Eqn. 5)

R 2=(Y+X)−(Z+W)  (Eqn. 6)

are sufficient to unambiguously identify each code word of vector signaling code H4 as represented by receive signal input values W, X, Y, Z. The values R0, R1, R2 may represent analog signal results if both the addition and difference functions are performed linearly, or may represent binary outputs if the difference function is performed by a digital comparator, equivalent to performing a sign( ) function on analog outputs. Because of the nature of the encoded H4 code words, none of the analog results R0, R1, R2 will be at zero, implying that none of the corresponding digital comparator results will be ambiguous.

For some encoder mappings of source data to transmitted H4 code words, a direct relationship between the detected result of these three receive comparators and the receive data exists, eliminating the need for additional decode mapping logic at the receiver. Thus, a preferred embodiment will first select the desired permutations of input signals to be processed by each of the three multi-input receive comparators, will then document the three comparator output values obtained for each valid code word, and will then define a transmit mapping function that performs the corresponding mapping of three transmit data bits to the four transmit signal values of the corresponding code word. One example of such a mapping is shown in FIG. 6.
 FIG. 5A shows a block diagram of such a receiver for a group of four wires using the H4 code. Each receive interconnection line 505 is terminated at 510. In some embodiments, line termination may further incorporate overvoltage protection, DC blocking capacitors, and introduction of a common mode or bias voltage for subsequent processing stages. Terminated receive signals 515 are presented to multi-input comparators 520, which perform the H4 detection by performing summation 521 and difference or comparison 522 operations. In this example, a direct mapping of comparator outputs to received data 525 is shown.
As with the described transmitter example, multiple processing phases may be used to allow symbol signaling rates greater than might be supported by a single circuit instance in the available semiconductor technology. FIG. 5B illustrates multi-phase receive processing, with an example four phase embodiment of receive comparator subsystem 524. To show the transparent nature of the multi-phase processing technique, the example portion 524 of FIG. 5A may be replaced by the four phase embodiment of FIG. 5B, retaining common inputs 515 and outputs 525.
As shown in FIG. 5B, terminated receive signals 515 are captured by sample-and-hold 530, providing stable signal levels 535 as inputs to each of the example four processing phases 540. To provide the maximum processing time to each processing phase 540 (which in this example is comprised of the receive comparator component 520 of FIG. 5A), one sample-and-hold per input signal is provided per phase (thus, in this example, sixteen total) with each operating at one quarter the receive symbol rate. Detected results 545 from all phases are combined by multiplexer 550 into a combined received data stream equivalent to that of FIG. 5A. Other embodiments may incorporate different numbers of phases and/or different numbers of sample-and-hold elements providing different timing constraints, and may incorporate greater or lesser amounts of the receive system into the multiple processing phases.
H4 Code with Digital Feedback Equalization
Modern high-speed serial receiver designs are strongly reliant on Decision Feedback Equalization (DFE) methods, which are well known solutions for compensation of transmission medium perturbations including signal reflections and crosstalk. It had been observed that such perturbations are driven by delayed components of previously transmitted data (e.g. as delayed reflections from impedance discontinuities in the communications path) which interfere with subsequently transmitted data. Thus, detected data may be stored by a DFE system at the receiver, and suitably delayed and attenuated components subtracted from the current input signal so as to nullify those effects.
This simple feedback loop DFE is constrained by the need to fully detect the value of the currently received data bit in time to feed it back as compensation for signals in the next signal interval. As transmission rates increase, this window of time becomes smaller. Furthermore, distributing receive processing across multiple processing phases increases throughput, at the cost of latency. Thus, information about a given receive interval's data may not be available for many receive cycles. Solutions using “unrolled” DFE correction are known, allowing inline compensation to be performed for the critical initial receive intervals of the DFE process.
Classic binary DFE solutions may be combined with the described H4 receiver designs at the point where individual modulation modes (representing individual data bits) are detected, if the signal reflections requiring compensation are similar for the four signal paths. Each mode is communicated as signals over all four signal paths, but the combinations of such signals is by definition orthogonal for each mode, thus signal perturbations on distinct paths is possible through judicious combination of modal compensations. It should be noted that signals encoded on the wire may take on any of four values (albeit two at any one time) while signals representing each transmission mode are always two-valued. Thus, storage and delay components of a DFE are at least twice as complex if performed on wire signals versus modulation mode signals.
One embodiment in accordance with the invention is shown in the block diagram of FIG. 7A. The four receive signal inputs 701 are input to receive detector 524 (previously described in FIGS. 5A and 5B), which in this example is configured to produce three analog outputs 705 corresponding to the transmission modes used to communicate each data bit. On each such analog output, a DFE correction signal 735 from one of three binary DFE circuits 730 is summed 710 to nullify the signal distortions on that analog signal, and the signals optionally converted to digital value by comparators 740.
As is well known to those familiar with the art, the required high gain of a digital comparator is often obtained using a series of stages of moderate gain. External signals may be injected at an interconnecting circuit node between two such stages; in one common example, an adjustable DC level is introduced at such a node to correct the comparator's input balance or offset. In another embodiment, elements 710 and 740 may thus represent stages within a multi-input comparator as in 520 of FIG. 5A. One familiar with the art will observe that a DFE correction signal may also be introduced at other circuit nodes, as one example at a comparator input, providing equivalent functionality.
As is common practice, the Decision Feedback Equalization corresponding to at least the first several bit times preceding the current receive interval are “unrolled” or performed inline along with the data path processing for higher performance, rather than by a closed loop feedback method, by the three unrolled binary DFE circuits 720, with DFE corresponding to the remaining bit times being compensated being performed by conventional feedback loop DFE at 730.
In the embodiment shown, feedback DFE circuits 730 accept digital bit inputs and output appropriately scaled and delayed analog signals, while unrolled DFE circuits 720 accepts digital inputs and produces digital bit outputs. Other embodiments in accordance with the invention may utilize different combinations of input signals and output results in the DFE components. In one embodiment, the three DFE circuits 730 operate on analog values 725, rather than from the equivalent binary values 745 obtained from comparators 740.
An alternative and more complex DFE embodiment of the invention is also known, which may be applied if the reflections are markedly different amongst the four wires. In this approach shown in FIG. 7B, DFE is performed by adding 760 four DFE correction signals 755, one for each analog wire signal 751 rather than for each transmission mode, allowing independent equalization for each physical wire path at the cost of significantly greater complexity and power consumption. The compensated wire signals are processed by receive detector 524 to produce outputs 765. In such an embodiment, at least the first several bits may be equalized by an unrolled binary DFE 770 operating on the three individual modulation modes as before. For corrections beyond that amount, an enhanced architecture DFE is used. The three data outputs 795 are re-encoded 780 into the corresponding four level symbol representation 736 used on the line, and four four-level DFE circuits 790 perform the remainder of the equalization, each operating on one wire-level signal to produce compensation signals 755. In some embodiments, the function of digital comparators 782 are performed within DFE 770, so that outputs 775 are equivalent to outputs 795. Similarly, in at least one embodiment unrolled DFE 770 operates on digital output signals from receive detector 524 representing binary data bits.
The number of bits of DFE compensation utilized in either described embodiment of the invention, both as inline “unrolled” DFE and as conventional feedback DFE, may be chosen based on the needs of the specific communications system, without limitation. At least one embodiment in accordance with the invention includes at least some DFE operations within the multiphase processing portion of the receiver.
Receive Method Description
To summarize and clarify the previous descriptions of receiver operations and their interactions with receive mode DFE and/or receive signal DFE, the following descriptions are made using the diagram of FIG. 9.
In element 910, signals from the separate channels of the communications medium are received, obtaining channel signal values representing the signal of each channel.
In some embodiments, additional processing including amplification, filtering, and frequency-dependent amplification may be performed on the signals of each channel as part of obtaining channel signal values, as is common practice. In some embodiments, correction signals derived from past channel activity are incorporated in this additional processing, as one example to neutralize past signal reflections and other spurious communications channel effects. Such correction based on past activity is known as Decision Feedback Equalization, herein being applied to channel signals.
In element 920, elements of the vector signaling code are detected by a method comprising obtaining a first sum of two selected channel signal values, obtaining a second sum of the remaining two channel signal values, and comparison of the first sum and the second sum to obtain the detected element. Multiple elements are detected by choosing different selected channel signal values for each element; for the example H4 vector signaling code, three such elements may be detected by three different permutations of channel signal values used to produce a first sum and a second sum.
In some embodiments, correction signals derived from previously detected elements of the vector signaling code are incorporated into detection of current elements of the vector signaling code, as one example in an alternative method of neutralizing past signal reflections and other spurious communications channel effects. As examples, a correction signal representing a compensation for past signal reflections and other spurious communication channel effects impacting one or more particular modulation modes may be introduced into element detection, so as to modify inputs to the comparison, or to bias the comparison operation itself. Such correction based on past activity is known as Decision Feedback Equalization, herein being applied to modulation modes of the communications channel.
In element 920, elements of the vector signaling code are detected by a method comprising obtaining a first sum of two selected channel signal values, obtaining a second sum of the remaining two channel signal values, and comparison of the first sum and the second sum to obtain the detected element. Multiple elements are detected by choosing different selected channel signal values for each element; for the example H4 vector signaling code, three such elements may be detected by three different permutations of channel signal values used to produce a first sum and a second sum.
In element 930, received data derived from the detected elements of the vector signaling code are output. As previously described, in preferred embodiments the transmit encoding is chosen such that the detected elements of the vector signaling code directly correspond to bits of the received data.
The described method thus measures and acts upon physical signal inputs, and produces a physical result of received data, which may be acted upon by subsequent components of a larger system or process.
The examples presented herein illustrate the use of vector signaling codes for point-to-point chip-to-chip interconnection. However, this should not been seen in any way as limiting the scope of the described invention. The methods disclosed in this application are equally applicable to other interconnection topologies and other communication media including optical, capacitive, inductive, and wireless communications. Thus, descriptive terms such as “voltage” or “signal level” should be considered to include equivalents in other measurement systems, such as “optical intensity”, “RF modulation”, etc. As used herein, the term “physical signal” includes any suitable behavior and/or attribute of a physical phenomenon capable of conveying information. Physical signals may be tangible and non-transitory.

We claim:
 
1. A method comprising:
receiving symbols of a codeword of a balanced vector signaling code via wires of a multi-wire bus;
introducing, via a respective signal summation node on each wire of the multi-wire bus, a corresponding correction signal for each wire, the correction signal generated based on a re-encoded symbol of a re-encoded codeword, the re-encoded codeword obtained by re-encoding a previously-decoded codeword;
forming a plurality of output signals using a plurality of multi-input comparators, each output signal formed by a respective multi-input comparator forming a respective weighted combination of the received symbols of the codeword, the respective weighted combination determined by a corresponding vector of an orthogonal matrix;
forming a plurality of output data bits from the plurality of output signals; and
generating a re-encoded codeword based on the plurality of output data bits for use in a set of symbols of a codeword received in a subsequent unit interval.


  
2. The method of claim 1, wherein the symbols of the codeword of the balanced vector signaling code have symbol values selected from the set {±1/3, ±1}.

  
3. The method of claim 2, wherein the codeword is a permutation of ±[1, −1/3, −1/3, −1/3].

  
4. The method of claim 1, wherein the orthogonal matrix is a Hadamard matrix.

  
5. The method of claim 4, wherein the Hadamard matrix is represented as:






H
4

=

[




+
1




+
1




+
1




+
1






+
1




-
1




+
1




-
1






+
1




+
1




-
1




-
1






+
1




-
1




-
1




+
1




]


,




and wherein the respective weighted combinations are represented by respective column vectors that sum to zero.

  
6. The method of claim 1, wherein forming the respective combination comprises:
obtaining a respective first sum of a first selected pair of symbols;
obtaining a respective second sum of a second selected pair of symbols; and
comparing the respective first sum and the respective second sum to obtain the respective output signal.


  
7. The method of claim 1, wherein the symbols of the re-encoded codeword are digital symbols.

  
8. The method of claim 1, wherein each correction signal has one of at least four possible values.

  
9. The method of claim 1, further comprising combining un-rolled decision-feedback equalization (DFE) with the plurality of output signals prior to generating the re-encoded codeword.

  
10. An apparatus comprising:
a set of summation nodes, each summation node configured to receive a respective symbol of a codeword of a balanced vector signaling code via a respective wire of a multi-wire bus and to responsively introduce a corresponding correction signal into the respective wire, the correction signal representing a re-encoded symbol of a re-encoded codeword, the re-encoded codeword obtained by re-encoding a previously-decoded codeword;
a plurality of multi-input comparators configured to form a plurality of output signals, each multi-input comparator configured to form a respective output signal by forming a respective weighted combination of the received symbols of the codeword, the respective weighted combination determined by a corresponding vector of an orthogonal matrix;
a plurality of slicers configured to receive the plurality of output signals and to responsively generate a plurality of output data bits; and
an encoder configured to generate a re-encoded codeword based on the output data bits for use in a set of symbols of a codeword received in a subsequent unit interval.


  
11. The apparatus of claim 10, wherein the symbols of the codeword of the balanced vector signaling code have symbol values selected from the set {±1/3, ±1}.

  
12. The apparatus of claim 11, wherein the codeword is a permutation of ±[1, −1/3, −1/3, −1/3].

  
13. The apparatus of claim 10, wherein the orthogonal matrix is a Hadamard matrix.

  
14. The apparatus of claim 13, wherein the Hadamard matrix is represented as:






H
4

=

[




+
1




+
1




+
1




+
1






+
1




-
1




+
1




-
1






+
1




+
1




-
1




-
1






+
1




-
1




-
1




+
1




]


,




and wherein the respective weighted combinations are represented by respective column vectors that sum to zero.

  
15. The apparatus of claim 10, wherein the multi-input comparators are configured to:
obtain a respective first sum of a first selected pair of symbols;
obtain a respective second sum of a second selected pair of symbols; and
compare the respective first sum and the respective second sum to obtain the respective output signal.


  
16. The apparatus of claim 10, wherein the symbols of the re-encoded codeword are digital symbols.

  
17. The apparatus of claim 10, wherein each correction signal has one of at least four possible values.

  
18. The apparatus of claim 10, further comprising un-rolled decision-feedback equalization (DFE) circuits configured to perform unrolled DFE on the plurality of output signals prior to generating the re-encoded codeword.